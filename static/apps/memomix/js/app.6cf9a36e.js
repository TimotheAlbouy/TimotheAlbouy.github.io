(function(e){function t(t){for(var r,i,a=t[0],u=t[1],l=t[2],p=0,d=[];p<a.length;p++)i=a[p],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&d.push(o[i][0]),o[i]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(e[r]=u[r]);c&&c(t);while(d.length)d.shift()();return s.push.apply(s,l||[]),n()}function n(){for(var e,t=0;t<s.length;t++){for(var n=s[t],r=!0,a=1;a<n.length;a++){var u=n[a];0!==o[u]&&(r=!1)}r&&(s.splice(t--,1),e=i(i.s=n[0]))}return e}var r={},o={app:0},s=[];function i(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],u=a.push.bind(a);a.push=t,a=a.slice();for(var l=0;l<a.length;l++)t(a[l]);var c=u;s.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";n("85ec")},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("2b0e"),o=n("5f5b"),s=n("b1e0"),i=(n("f9e3"),n("2dd8"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("splitpanes",{staticClass:"default-theme",staticStyle:{height:"100vh"},attrs:{horizontal:""}},[n("pane",{staticClass:"horizontalPane"},[n("splitpanes",{attrs:{vertical:""}},[n("pane",[n("group-pane",{attrs:{groups:e.groups},on:{"group-to-update":e.updateGroup,"group-to-add":e.addGroup,"group-to-remove":e.removeGroup}})],1),n("pane",[n("person-pane",{attrs:{persons:e.persons},on:{"person-to-update":e.updatePerson,"person-to-add":e.addPerson,"person-to-remove":e.removePerson}})],1),n("pane",[n("constraint-pane",{attrs:{constraints:e.constraints,persons:e.persons,groups:e.groups},on:{"constraint-to-update":e.updateConstraint,"constraint-to-add":e.addConstraint,"constraint-to-remove":e.removeConstraint}})],1)],1)],1),n("pane",{staticClass:"horizontalPane"},[n("splitpanes",[n("pane",[n("history-pane",{attrs:{history:e.history},on:{"entry-to-remove":e.removeEntry}})],1),n("pane",[n("entry-pane",{attrs:{groups:e.groups,persons:e.persons,constraints:e.constraints,history:e.history},on:{"entry-to-save":e.saveEntry}})],1)],1)],1)],1)],1)}),a=[],u=n("b85c"),l=(n("a434"),n("7db0"),n("512e")),c=(n("c1ea"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("group-modal",{attrs:{"old-group":e.activeGroup,groups:e.groups},on:{"group-to-update":function(t,n){return e.updateGroup(e.activeIndex,t,n)},"group-to-add":function(t){return e.addGroup(t)},"group-to-remove":function(){return e.removeGroup(e.activeIndex)}},model:{value:e.showGroupModal,callback:function(t){e.showGroupModal=t},expression:"showGroupModal"}}),n("div",{staticClass:"sticky-top bg-light d-inline-block w-100"},[n("span",{staticClass:"float-left h5"},[e._v("Groupes")]),n("span",{staticClass:"float-right"},[n("button",{directives:[{name:"b-hover",rawName:"v-b-hover",value:function(t){return e.addGroupBtnHover=t},expression:"hover => addGroupBtnHover = hover"}],class:"btn btn-link btn-sm "+(e.addGroupBtnHover?"text-success":"text-body"),on:{click:function(t){return e.openGroupModal(-1)}}},[e._v(" Nouveau groupe "),n("b-icon-plus-circle")],1)])]),n("b-table",{attrs:{small:"",striped:"",hover:"",fields:e.groupFields,items:e.groups},on:{"row-hovered":function(t,n){return e.groupRowHoverIndex=n},"row-unhovered":function(t,n){return e.groupRowHoverIndex=-1}},scopedSlots:e._u([{key:"cell(updateBtn)",fn:function(t){return[n("div",{staticClass:"float-right"},[n("button",{directives:[{name:"b-hover",rawName:"v-b-hover",value:function(t){return e.updateGroupBtnHover=t},expression:"hover => updateGroupBtnHover = hover"}],class:"btn btn-link btn-sm"+(e.updateGroupBtnHover?" text-success":" text-body")+(e.groupRowHoverIndex==t.index?" visible":" invisible"),on:{click:function(n){return e.openGroupModal(t.index)}}},[n("b-icon-pencil")],1)])]}}])})],1)}),p=[],d=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("b-modal",{attrs:{title:e.modalTitle},on:{show:e.reinitGroupModal,hide:e.reinitGroupModal},scopedSlots:e._u([{key:"default",fn:function(){return[n("b-form",{attrs:{novalidate:""},on:{submit:function(e){return e.preventDefault()}}},[n("b-form-group",{attrs:{label:"Identifiant du groupe","label-for":"groupId"}},[n("b-form-input",{attrs:{type:"text",state:!e.groupIdConflict&&null,required:"",maxlength:"32",placeholder:"Identifiant du groupe (e.g. nom d'une tâche) "},model:{value:e.newGroup.groupId,callback:function(t){e.$set(e.newGroup,"groupId","string"===typeof t?t.trim():t)},expression:"newGroup.groupId"}}),n("div",{staticClass:"invalid-feedback"},[e._v(" Le groupe existe déjà. ")])],1),n("b-form-group",{attrs:{label:"Taille du groupe","label-for":"size"}},[n("b-form-input",{attrs:{type:"number",required:""},model:{value:e.newGroup.size,callback:function(t){e.$set(e.newGroup,"size",e._n(t))},expression:"newGroup.size"}})],1),e.isCreationModal?e._e():n("b-form-checkbox",{model:{value:e.newGroup.updateHistory,callback:function(t){e.$set(e.newGroup,"updateHistory",t)},expression:"newGroup.updateHistory"}},[e._v(" Modifier les occurrences du groupe dans l'historique ")])],1)]},proxy:!0},{key:"modal-footer",fn:function(){return[n("b-button",{attrs:{variant:"success"},on:{click:e.checkGroup}},[e._v(" Valider "),n("b-icon-check-circle")],1),e.isCreationModal?e._e():n("b-button",{attrs:{variant:"danger"},on:{click:e.removeGroup}},[e._v(" Supprimer "),n("b-icon-x-circle")],1)]},proxy:!0}]),model:{value:e.showGroupModal,callback:function(t){e.showGroupModal=t},expression:"showGroupModal"}})],1)},v=[],h={name:"GroupModal",props:{value:{type:Boolean,required:!0},oldGroup:{type:Object},groups:{type:Array,required:!0}},data:function(){return{newGroup:this.generateNewGroup(),updateHistory:!0}},methods:{generateNewGroup:function(){return this.oldGroup?{groupId:this.oldGroup.groupId,size:this.oldGroup.size}:{groupId:"",size:1}},reinitGroupModal:function(){this.newGroup=this.generateNewGroup(),this.updateHistory=!0},updateGroup:function(){this.$emit("group-to-update",this.newGroup,this.updateHistory),this.showGroupModal=!1},addGroup:function(){this.$emit("group-to-add",this.newGroup),this.showGroupModal=!1},removeGroup:function(){this.$emit("group-to-remove"),this.showGroupModal=!1},checkGroup:function(){var e=!this.groupIdConflict&&this.newGroup.groupId.length>=1;e&&(this.isCreationModal?this.addGroup():this.updateGroup())}},computed:{showGroupModal:{get:function(){return this.value},set:function(e){return this.$emit("input",e)}},isCreationModal:function(){return null==this.oldGroup},modalTitle:function(){return this.isCreationModal?"Ajouter un groupe":"Modifier le groupe"},groupIdConflict:function(){var e=this,t=this.groups.find((function(t){return t.groupId==e.newGroup.groupId}));if(void 0==t)return!1;if(this.isCreationModal)return!0;var n=this.oldGroup.groupId,r=t.groupId;return n!=r}}},f=h,y=n("2877"),g=Object(y["a"])(f,d,v,!1,null,null,null),b=g.exports,m={name:"GroupPane",components:{GroupModal:b},props:{groups:{type:Array,required:!0}},data:function(){return{groupFields:[{key:"groupId",label:"ID"},{key:"size",label:"Taille"},{key:"updateBtn",label:""}],addGroupBtnHover:!1,updateGroupBtnHover:!1,groupRowHoverIndex:-1,activeIndex:-1,activeGroup:null,showGroupModal:!1}},methods:{updateGroup:function(e,t,n){this.$emit("group-to-update",e,t,n)},addGroup:function(e){this.$emit("group-to-add",e)},removeGroup:function(e){this.$emit("group-to-remove",e),this.updateGroupBtnHover=!1},openGroupModal:function(e){this.activeIndex=e,this.activeGroup=-1==e?null:this.groups[e],this.showGroupModal=!0}}},w=m,I=Object(y["a"])(w,c,p,!1,null,null,null),G=I.exports,P=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("person-modal",{attrs:{"old-person":e.activePerson,persons:e.persons},on:{"person-to-update":function(t,n){return e.updatePerson(e.activeIndex,t,n)},"person-to-add":function(t){return e.addPerson(t)},"person-to-remove":function(){return e.removePerson(e.activeIndex)}},model:{value:e.showPersonModal,callback:function(t){e.showPersonModal=t},expression:"showPersonModal"}}),n("div",{staticClass:"sticky-top bg-light d-inline-block w-100"},[n("span",{staticClass:"float-left h5"},[e._v("Personnes")]),n("span",{staticClass:"float-right"},[n("button",{directives:[{name:"b-hover",rawName:"v-b-hover",value:function(t){return e.addPersonBtnHover=t},expression:"hover => addPersonBtnHover = hover"}],class:"btn btn-link btn-sm "+(e.addPersonBtnHover?"text-success":"text-body"),on:{click:function(t){return e.openPersonModal(-1)}}},[e._v(" Nouvelle personne "),n("b-icon-plus-circle")],1)])]),n("b-table",{attrs:{small:"",striped:"",hover:"",fields:e.personFields,items:e.persons},on:{"row-hovered":function(t,n){return e.personRowHoverIndex=n},"row-unhovered":function(t,n){return e.personRowHoverIndex=-1}},scopedSlots:e._u([{key:"cell(updateBtn)",fn:function(t){return[n("div",{staticClass:"float-right"},[n("button",{directives:[{name:"b-hover",rawName:"v-b-hover",value:function(t){return e.updatePersonBtnHover=t},expression:"hover => updatePersonBtnHover = hover"}],class:"btn btn-link btn-sm"+(e.updatePersonBtnHover?" text-success":" text-body")+(e.personRowHoverIndex==t.index?" visible":" invisible"),on:{click:function(n){return e.openPersonModal(t.index)}}},[n("b-icon-pencil")],1)])]}}])})],1)},x=[],C=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("b-modal",{attrs:{title:e.modalTitle},on:{show:e.reinitPersonModal,hide:e.reinitPersonModal},scopedSlots:e._u([{key:"default",fn:function(){return[n("b-form",{attrs:{novalidate:""},on:{submit:function(e){return e.preventDefault()}}},[n("b-form-group",{attrs:{label:"Identifiant de la personne","label-for":"personId"}},[n("b-form-input",{attrs:{type:"text",state:!e.personIdConflict&&null,required:"",maxlength:"32",placeholder:"Identifiant de la personne (e.g. Prénom + Nom)"},model:{value:e.newPerson.personId,callback:function(t){e.$set(e.newPerson,"personId","string"===typeof t?t.trim():t)},expression:"newPerson.personId"}}),n("div",{staticClass:"invalid-feedback"},[e._v(" La personne existe déjà. ")])],1),e.isCreationModal?e._e():n("b-form-checkbox",{model:{value:e.updateHistory,callback:function(t){e.updateHistory=t},expression:"updateHistory"}},[e._v(" Modifier les occurrences de la personne dans l'historique ")])],1)]},proxy:!0},{key:"modal-footer",fn:function(){return[n("b-button",{attrs:{variant:"success"},on:{click:e.checkPerson}},[e._v(" Valider "),n("b-icon-check-circle")],1),e.isCreationModal?e._e():n("b-button",{attrs:{variant:"danger"},on:{click:e.removePerson}},[e._v(" Supprimer "),n("b-icon-x-circle")],1)]},proxy:!0}]),model:{value:e.showPersonModal,callback:function(t){e.showPersonModal=t},expression:"showPersonModal"}})],1)},k=[],O={name:"PersonModal",props:{value:{type:Boolean,required:!0},oldPerson:{type:Object},persons:{type:Array,required:!0}},data:function(){return{newPerson:this.generateNewPerson(),updateHistory:!0}},methods:{generateNewPerson:function(){return this.oldPerson?{personId:this.oldPerson.personId}:{personId:""}},reinitPersonModal:function(){this.newPerson=this.generateNewPerson(),this.updateHistory=!0},updatePerson:function(){this.$emit("person-to-update",this.newPerson,this.updateHistory),this.showPersonModal=!1},addPerson:function(){this.$emit("person-to-add",this.newPerson),this.showPersonModal=!1},removePerson:function(){this.$emit("person-to-remove"),this.showPersonModal=!1},checkPerson:function(){var e=!this.personIdConflict&&this.newPerson.personId.length>=1;e&&(this.isCreationModal?this.addPerson():this.updatePerson())}},computed:{showPersonModal:{get:function(){return this.value},set:function(e){return this.$emit("input",e)}},isCreationModal:function(){return null==this.oldPerson},modalTitle:function(){return this.isCreationModal?"Ajouter une personne":"Modifier la personne"},personIdConflict:function(){var e=this,t=this.persons.find((function(t){return t.personId==e.newPerson.personId}));if(void 0==t)return!1;if(this.isCreationModal)return!0;var n=this.oldPerson.personId,r=t.personId;return n!=r}}},M=O,S=Object(y["a"])(M,C,k,!1,null,null,null),E=S.exports,j={name:"PersonPane",components:{PersonModal:E},props:{persons:{type:Array,required:!0}},data:function(){return{personFields:[{key:"personId",label:"ID"},{key:"updateBtn",label:""}],addPersonBtnHover:!1,updatePersonBtnHover:!1,personRowHoverIndex:-1,activeIndex:-1,activePerson:null,showPersonModal:!1}},methods:{updatePerson:function(e,t,n){this.$emit("person-to-update",e,t,n)},addPerson:function(e){this.$emit("person-to-add",e)},removePerson:function(e){this.$emit("person-to-remove",e),this.updatePersonBtnHover=!1},openPersonModal:function(e){this.activeIndex=e,this.activePerson=-1==e?null:this.persons[e],this.showPersonModal=!0}}},H=j,_=Object(y["a"])(H,P,x,!1,null,null,null),B=_.exports,z=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("constraint-modal",{attrs:{"old-constraint":e.activeConstraint,groups:e.groups,persons:e.persons},on:{"constraint-to-update":function(t){return e.updateConstraint(e.activeIndex,t)},"constraint-to-add":function(t){return e.addConstraint(t)},"constraint-to-remove":function(t){return e.removeConstraint(e.activeIndex)}},model:{value:e.showConstraintModal,callback:function(t){e.showConstraintModal=t},expression:"showConstraintModal"}}),n("div",{staticClass:"sticky-top bg-light d-inline-block w-100"},[n("span",{staticClass:"float-left h5"},[e._v("Contraintes")]),n("span",{staticClass:"float-right"},[n("button",{directives:[{name:"b-hover",rawName:"v-b-hover",value:function(t){return e.addConstraintBtnHover=t},expression:"hover => addConstraintBtnHover = hover"}],class:"btn btn-link btn-sm "+(e.addConstraintBtnHover?"text-success":"text-body"),on:{click:e.openConstraintModal}},[e._v(" Nouvelle contrainte "),n("b-icon-plus-circle")],1)])]),n("b-table",{attrs:{small:"",striped:"",hover:"",fields:e.constraintFields,items:e.constraints},on:{"row-hovered":function(t,n){return e.constraintRowHoverIndex=n},"row-unhovered":function(t,n){return e.constraintRowHoverIndex=-1}},scopedSlots:e._u([{key:"cell(type)",fn:function(t){return[e._v(" "+e._s(e.constraintTypes[t.item.type])+" ")]}},{key:"cell(personIds)",fn:function(t){return[e._v(" "+e._s(t.item.persons.map((function(e){return e.personId})).join(", "))+" ")]}},{key:"cell(updateBtn)",fn:function(t){return[n("div",{staticClass:"float-right"},[n("button",{directives:[{name:"b-hover",rawName:"v-b-hover",value:function(t){return e.updateConstraintBtnHover=t},expression:"hover => updateConstraintBtnHover = hover"}],class:"btn btn-link btn-sm"+(e.updateConstraintBtnHover?" text-success":" text-body")+(e.constraintRowHoverIndex==t.index?" visible":" invisible"),on:{click:function(n){return e.openConstraintModal(t.index)}}},[n("b-icon-pencil")],1)])]}}])})],1)},A=[],N=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("b-modal",{attrs:{title:e.modalTitle},on:{show:e.reinitConstraintModal,hide:e.reinitConstraintModal},scopedSlots:e._u([{key:"default",fn:function(){return[e.newConstraint?n("div",[n("b-form-group",{attrs:{label:"Type","label-for":"type"}},[n("b-form-select",{attrs:{options:e.typeOptions,id:"type"},model:{value:e.newConstraint.type,callback:function(t){e.$set(e.newConstraint,"type",t)},expression:"newConstraint.type"}})],1),n("b-form-group",{attrs:{label:"Ajouter une personne","label-for":"newPerson"}},[n("b-form-select",{attrs:{options:e.personOptions,id:"newPerson"},on:{change:function(t){return e.addPerson(t)}},scopedSlots:e._u([{key:"first",fn:function(){return[n("b-form-select-option",{attrs:{value:"",disabled:""}},[e._v("-- Sélectionner une personne --")])]},proxy:!0}],null,!1,4021855126),model:{value:e.reinitSelectPerson,callback:function(t){e.reinitSelectPerson=t},expression:"reinitSelectPerson"}})],1),e.newConstraint.persons.length>=1?n("div",[n("b-table",{attrs:{small:"",striped:"",hover:"",fields:e.personFields,items:e.newConstraint.persons},on:{"row-hovered":function(t,n){return e.personRowHoverIndex=n},"row-unhovered":function(t,n){return e.personRowHoverIndex=-1}},scopedSlots:e._u([{key:"cell(removeBtn)",fn:function(t){return[n("div",{staticClass:"float-right"},[n("button",{directives:[{name:"b-hover",rawName:"v-b-hover",value:function(t){return e.removePersonBtnHover=t},expression:"hover => removePersonBtnHover = hover"}],class:"btn btn-link btn-sm"+(e.removePersonBtnHover?" text-danger":" text-body")+(e.personRowHoverIndex==t.index?" visible":" invisible"),on:{click:function(n){return e.removePerson(t.index)}}},[n("b-icon-x-circle")],1)])]}}],null,!1,4039853407)})],1):e._e(),"together"==e.newConstraint.type?n("div",[n("b-form-group",{attrs:{label:"Dans le groupe","label-for":"inGroup"}},[n("b-form-select",{attrs:{options:e.groupOptions,id:"inGroup",disabled:e.newConstraint.notInGroups.length>=1},scopedSlots:e._u([{key:"first",fn:function(){return[n("b-select-option",{attrs:{value:null}})]},proxy:!0}],null,!1,26767175),model:{value:e.newConstraint.inGroup,callback:function(t){e.$set(e.newConstraint,"inGroup",t)},expression:"newConstraint.inGroup"}})],1),n("b-form-group",{attrs:{label:"Pas dans les groupes","label-for":"notInGroups"}},[n("b-form-select",{attrs:{options:e.groupOptions,id:"notInGroups",disabled:null!=e.newConstraint.inGroup},on:{change:function(t){return e.addGroup(t)}},scopedSlots:e._u([{key:"first",fn:function(){return[n("b-form-select-option",{attrs:{value:"",disabled:""}},[e._v("-- Sélectionner un groupe --")])]},proxy:!0}],null,!1,2889731287),model:{value:e.reinitSelectGroup,callback:function(t){e.reinitSelectGroup=t},expression:"reinitSelectGroup"}})],1),e.newConstraint.notInGroups.length>=1?n("div",[n("b-table",{attrs:{small:"",striped:"",hover:"",fields:e.groupFields,items:e.newConstraint.notInGroups},scopedSlots:e._u([{key:"cell(removeBtn)",fn:function(t){return[n("div",{staticClass:"float-right"},[n("button",{directives:[{name:"b-hover",rawName:"v-b-hover",value:function(t){return e.removeGroupBtnHover=t},expression:"hover => removeGroupBtnHover = hover"}],class:"btn btn-link btn-sm"+(e.removeGroupBtnHover?" text-danger":" text-body")+(e.groupRowHoverIndex==t.index?" visible":" invisible"),on:{click:function(n){return e.removeGroup(t.index)}}},[n("b-icon-x-circle")],1)])]}}],null,!1,1387577813)})],1):e._e()],1):e._e()],1):e._e()]},proxy:!0},{key:"modal-footer",fn:function(){return[n("b-button",{attrs:{variant:"success"},on:{click:e.checkConstraint}},[e._v(" Valider "),n("b-icon-check-circle")],1),e.isCreationModal?e._e():n("b-button",{attrs:{variant:"danger"},on:{click:e.removeConstraint}},[e._v(" Supprimer "),n("b-icon-x-circle")],1)]},proxy:!0}]),model:{value:e.showConstraintModal,callback:function(t){e.showConstraintModal=t},expression:"showConstraintModal"}})],1)},$=[],q=n("2909"),R={name:"ConstraintModal",props:{value:{type:Boolean,required:!0},oldConstraint:{type:Object},persons:{type:Array,required:!0},groups:{type:Array,required:!0}},data:function(){return{newConstraint:this.generateNewConstraint(),typeOptions:[{value:"apart",text:"Séparés"},{value:"together",text:"Ensemble"}],personOptions:this.generatePersonOptions(),personFields:[{key:"personId",label:"Personnes"},{key:"removeBtn",label:""}],groupOptions:this.generateGroupOptions(),groupFields:[{key:"groupId",label:"Groupes interdits"},{key:"removeBtn",label:""}],removePersonBtnHover:!1,personRowHoverIndex:-1,removeGroupBtnHover:!1,groupRowHoverIndex:-1,reinitSelectPerson:null,reinitSelectGroup:null}},methods:{generateNewConstraint:function(){return this.oldConstraint?{type:this.oldConstraint.type,persons:Object(q["a"])(this.oldConstraint.persons),inGroup:this.oldConstraint.inGroup,notInGroups:Object(q["a"])(this.oldConstraint.notInGroups)}:{type:"apart",persons:[],inGroup:null,notInGroups:[]}},reinitConstraintModal:function(){this.newConstraint=this.generateNewConstraint(),this.personOptions=this.generatePersonOptions(),this.groupOptions=this.generateGroupOptions()},updateConstraint:function(){this.$emit("constraint-to-update",this.newConstraint),this.showConstraintModal=!1},addConstraint:function(){this.$emit("constraint-to-add",this.newConstraint),this.showConstraintModal=!1},removeConstraint:function(){this.$emit("constraint-to-remove"),this.showConstraintModal=!1},addPerson:function(e){this.newConstraint.persons.push({personId:e}),this.personOptions=this.generatePersonOptions()},removePerson:function(e){var t=this.newConstraint.persons[e].personId;this.newConstraint.persons.splice(e,1),this.personOptions.push({value:t,text:t}),this.reinitSelectPerson=null,this.removePersonBtnHover=!1},addGroup:function(e){this.newConstraint.notInGroups.push({groupId:e}),this.groupOptions=this.generateGroupOptions()},removeGroup:function(e){this.newConstraint.notInGroups.splice(e,1),this.groupOptions=this.generateGroupOptions(),this.reinitSelectGroup=null,this.removeGroupBtnHover=!1},generatePersonOptions:function(){var e=this,t=[];if(this.newConstraint){var n,r=Object(u["a"])(this.persons);try{var o=function(){var r=n.value;e.newConstraint.persons.every((function(e){var t=e.personId;return t!=r.personId}))&&t.push({value:r.personId,text:r.personId})};for(r.s();!(n=r.n()).done;)o()}catch(s){r.e(s)}finally{r.f()}}return t},generateGroupOptions:function(){var e=this,t=[];if(this.newConstraint){var n,r=Object(u["a"])(this.groups);try{var o=function(){var r=n.value;e.newConstraint.notInGroups.every((function(e){var t=e.groupId;return t!=r.groupId}))&&t.push({value:r.groupId,text:r.groupId})};for(r.s();!(n=r.n()).done;)o()}catch(s){r.e(s)}finally{r.f()}}return t},checkConstraint:function(){var e=this.newConstraint.persons.length>=1;e&&(this.isCreationModal?this.addConstraint():this.updateConstraint())}},watch:{persons:function(){this.personOptions=this.generatePersonOptions()},groups:function(){this.groupOptions=this.generateGroupOptions()}},computed:{showConstraintModal:{get:function(){return this.value},set:function(e){return this.$emit("input",e)}},isCreationModal:function(){return null==this.oldConstraint},modalTitle:function(){return this.isCreationModal?"Ajouter une contrainte":"Modifier la contrainte"}}},T=R,F=Object(y["a"])(T,N,$,!1,null,null,null),J=F.exports,V={name:"ConstraintPane",components:{ConstraintModal:J},props:{constraints:{type:Array,required:!0},persons:{type:Array,required:!0},groups:{type:Array,required:!0}},data:function(){return{constraintFields:[{key:"type",label:"Type"},{key:"personIds",label:"Personnes"},{key:"updateBtn",label:""}],addConstraintBtnHover:!1,updateConstraintBtnHover:!1,constraintRowHoverIndex:-1,activeIndex:-1,activeConstraint:null,showConstraintModal:!1,constraintTypes:{apart:"Séparés",together:"Ensemble"}}},methods:{updateConstraint:function(e,t){this.$emit("constraint-to-update",e,t)},addConstraint:function(e){this.$emit("constraint-to-add",e)},removeConstraint:function(e){this.$emit("constraint-to-remove",e),this.removeConstraintHover=-1},openConstraintModal:function(e){this.activeIndex=e,this.activeConstraint=-1==e?null:this.constraints[e],this.showConstraintModal=!0}},watch:{persons:{deep:!0,handler:function(){}}}},K=V,D=Object(y["a"])(K,z,A,!1,null,null,null),L=D.exports,Q=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("entry-modal",{attrs:{"remaining-persons":e.remainingPersons,"old-entry-group":e.activeEntryGroup},on:{"entry-group-to-update":e.updateEntryGroup},model:{value:e.showEntryModal,callback:function(t){e.showEntryModal=t},expression:"showEntryModal"}}),n("save-entry-modal",{attrs:{"remaining-persons":e.remainingPersons},on:{"entry-to-save":e.saveEntry},model:{value:e.showSaveEntryModal,callback:function(t){e.showSaveEntryModal=t},expression:"showSaveEntryModal"}}),n("div",{staticClass:"sticky-top bg-light d-inline-block w-100"},[n("span",{staticClass:"float-left h5"},[e._v("Proposition")]),n("span",{staticClass:"float-right"},[e.entry.groups.length>0?n("button",{directives:[{name:"b-hover",rawName:"v-b-hover",value:function(t){return e.saveEntryBtnHover=t},expression:"hover => saveEntryBtnHover = hover"}],class:"btn btn-link btn-sm "+(e.saveEntryBtnHover?"text-success":"text-body"),on:{click:function(t){e.showSaveEntryModal=!0}}},[e._v(" Sauvegarder "),n("b-icon-check-circle")],1):e._e(),n("button",{directives:[{name:"b-hover",rawName:"v-b-hover",value:function(t){return e.generateEntryBtnHover=t},expression:"hover => generateEntryBtnHover = hover"}],class:"btn btn-link btn-sm "+(e.generateEntryBtnHover?"text-primary":"text-body"),on:{click:e.generateEntry}},[e._v(" Générer "),n("b-icon-play-circle")],1)])]),n("b-table",{attrs:{small:"",striped:"",hover:"",fields:e.entryFields,items:e.entry.groups},on:{"row-hovered":function(t,n){return e.entryGroupRowHoverIndex=n},"row-unhovered":function(t,n){return e.entryGroupRowHoverIndex=-1}},scopedSlots:e._u([{key:"cell(personIds)",fn:function(t){return[e._v(" "+e._s(t.item.persons.map((function(e){return e.personId})).join(", "))+" ")]}},{key:"cell(updateBtn)",fn:function(t){return[n("div",{staticClass:"float-right"},[n("button",{directives:[{name:"b-hover",rawName:"v-b-hover",value:function(t){return e.updateEntryGroupBtnHover=t},expression:"hover => updateEntryGroupBtnHover = hover"}],class:"btn btn-link btn-sm"+(e.updateEntryGroupBtnHover?" text-success":" text-body")+(e.entryGroupRowHoverIndex==t.index?" visible":" invisible"),on:{click:function(n){return e.openEntryModal(t.index)}}},[n("b-icon-pencil")],1)])]}}])}),e.remainingPersons.length>=1?n("p",[n("span",{staticClass:"font-italic font-weight-bold"},[e._v("Personnes restantes :")]),e._v(" "+e._s(e.remainingPersons.map((function(e){return e.personId})).join(", "))+" ")]):e._e()],1)},U=[],W=n("3835"),X=(n("6062"),n("d3b7"),n("3ca3"),n("ddb0"),n("d81d"),n("4ec9"),n("a630"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("b-modal",{attrs:{title:e.modalTitle},on:{show:e.reinitEntryModal,hide:e.reinitEntryModal},scopedSlots:e._u([{key:"default",fn:function(){return[e.newEntryGroup?n("div",[n("b-form-group",{attrs:{label:"Ajouter une personne","label-for":"newPerson"}},[n("b-form-select",{attrs:{options:e.personOptions,id:"newPerson"},on:{change:function(t){return e.addPerson(t)}},scopedSlots:e._u([{key:"first",fn:function(){return[n("b-form-select-option",{attrs:{value:"",disabled:""}},[e._v("-- Sélectionner une personne --")])]},proxy:!0}],null,!1,4021855126),model:{value:e.reinitSelectPerson,callback:function(t){e.reinitSelectPerson=t},expression:"reinitSelectPerson"}})],1),e.newEntryGroup.persons.length>=1?n("div",[n("b-table",{attrs:{small:"",striped:"",hover:"",fields:e.personFields,items:e.newEntryGroup.persons},on:{"row-hovered":function(t,n){return e.personRowHoverIndex=n},"row-unhovered":function(t,n){return e.personRowHoverIndex=-1}},scopedSlots:e._u([{key:"cell(removeBtn)",fn:function(t){return[n("div",{staticClass:"float-right"},[n("button",{directives:[{name:"b-hover",rawName:"v-b-hover",value:function(t){return e.removePersonBtnHover=t},expression:"hover => removePersonBtnHover = hover"}],class:"btn btn-link btn-sm"+(e.removePersonBtnHover?" text-danger":" text-body")+(e.personRowHoverIndex==t.index?" visible":" invisible"),on:{click:function(n){return e.removePerson(t.index)}}},[n("b-icon-x-circle")],1)])]}}],null,!1,4039853407)})],1):e._e()],1):e._e()]},proxy:!0},{key:"modal-footer",fn:function(){return[n("b-button",{attrs:{variant:"success"},on:{click:e.checkEntryGroup}},[e._v(" Valider "),n("b-icon-check-circle")],1)]},proxy:!0}]),model:{value:e.showEntryModal,callback:function(t){e.showEntryModal=t},expression:"showEntryModal"}})],1)}),Y=[],Z={name:"EntryModal",props:{value:{type:Boolean,required:!0},oldEntryGroup:{type:Object},remainingPersons:{type:Array,required:!0}},data:function(){return{newEntryGroup:this.generateNewEntryGroup(),personFields:[{key:"personId",label:"Personnes"},{key:"removeBtn",label:""}],personOptions:this.generatePersonOptions(),removePersonBtnHover:!1,personRowHoverIndex:-1,reinitSelectPerson:null}},methods:{generateNewEntryGroup:function(){return this.oldEntryGroup?{groupId:this.oldEntryGroup.groupId,persons:Object(q["a"])(this.oldEntryGroup.persons)}:{groupId:null,persons:[]}},reinitEntryModal:function(){this.newEntryGroup=this.generateNewEntryGroup(),this.personOptions=this.generatePersonOptions()},updateEntryGroup:function(){var e=this.personOptions.map((function(e){return{personId:e.value}}));this.$emit("entry-group-to-update",this.newEntryGroup,e),this.showEntryModal=!1},addPerson:function(e){var t;for(this.newEntryGroup.persons.push({personId:e}),t=0;t<this.personOptions.length;t++)if(this.personOptions[t].value==e)break;this.personOptions.splice(t,1),this.reinitSelectPerson=null},removePerson:function(e){var t=this.newEntryGroup.persons[e].personId;this.newEntryGroup.persons.splice(e,1),this.personOptions.push({value:t,text:t}),this.removePersonBtnHover=!1},generatePersonOptions:function(){var e=[];if(this.newEntryGroup){var t,n=Object(u["a"])(this.remainingPersons);try{for(n.s();!(t=n.n()).done;){var r=t.value;e.push({value:r.personId,text:r.personId})}}catch(o){n.e(o)}finally{n.f()}}return e},checkEntryGroup:function(){var e=!0;e&&this.updateEntryGroup()}},watch:{persons:function(){this.personOptions=this.generatePersonOptions()}},computed:{showEntryModal:{get:function(){return this.value},set:function(e){return this.$emit("input",e)}},modalTitle:function(){return this.oldEntryGroup?"Modifier le groupe '"+this.oldEntryGroup.groupId+"'":""}}},ee=Z,te=Object(y["a"])(ee,X,Y,!1,null,null,null),ne=te.exports,re=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("b-modal",{attrs:{title:"Sauvegarder la proposition"},scopedSlots:e._u([{key:"default",fn:function(){return[n("b-form-group",{attrs:{label:"Titre","label-for":"entryTitle"}},[n("b-form-input",{attrs:{type:"text",required:"",maxlength:"32",placeholder:"Titre de la proposition (e.g. Date + Objet)"},model:{value:e.entryTitle,callback:function(t){e.entryTitle="string"===typeof t?t.trim():t},expression:"entryTitle"}})],1),e.remainingPersons.length>=1?n("p",{staticClass:"text-danger"},[n("span",{staticClass:"font-italic font-weight-bold"},[n("b-icon-exclamation-triangle"),e._v(" Certaines personnes n'ont pas été placées : ")],1),e._v(" "+e._s(e.remainingPersons.map((function(e){return e.personId})).join(", "))+" ")]):e._e()]},proxy:!0},{key:"modal-footer",fn:function(){return[n("b-button",{attrs:{variant:"success"},on:{click:e.saveEntry}},[e._v(" Valider "),n("b-icon-check-circle")],1)]},proxy:!0}]),model:{value:e.showSaveEntryModal,callback:function(t){e.showSaveEntryModal=t},expression:"showSaveEntryModal"}})],1)},oe=[],se={name:"SaveEntryModal",props:{value:{type:Boolean,required:!0},remainingPersons:{type:Array,required:!0}},data:function(){return{entryTitle:null}},methods:{saveEntry:function(){this.entryTitle.length>=1&&(this.$emit("entry-to-save",this.entryTitle),this.showSaveEntryModal=!1)}},computed:{showSaveEntryModal:{get:function(){return this.value},set:function(e){return this.$emit("input",e)}}}},ie=se,ae=Object(y["a"])(ie,re,oe,!1,null,null,null),ue=ae.exports,le=n("53ca"),ce=n("d4ec"),pe=n("bee2"),de=(n("fb6a"),n("b64b"),n("caad"),n("2532"),n("4de4"),n("159b"),n("13d5"),function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;Object(ce["a"])(this,e),r||(r=[]),o||(o=[]),s||(s=[]),me(t.size<=fe(Array.from(n.values())),"The groups cannot contain all the persons."),me(be(Array.from(n.values()),(function(e){return e>=1})),"At least one group has a negative or null size.");var i,a=Object(u["a"])(r);try{for(a.s();!(i=a.n()).done;){var l=i.value;me(this.checkEntryValidity(l),"Invalid entry.")}}catch(c){a.e(c)}finally{a.f()}this.personIds=t,this.groupSizes=n,this.history=r,me(this.checkConstraintsValidity(o,s),"Invalid constraints."),this.togetherConstraints=o,this.apartConstraints=s}return Object(pe["a"])(e,[{key:"setPersonIds",value:function(e){me(e.size<=fe(Array.from(this.groupSizes.values())),"The groups cannot contain all the persons."),this.personIds=e}},{key:"setGroupSizes",value:function(e){me(this.personIds.size<=fe(Array.from(e.values())),"The groups cannot contain all the persons."),me(be(Array.from(e.values()),(function(e){return e>=1})),"At least one group has a negative or null size."),this.groupSizes=e}},{key:"setConstraints",value:function(e,t){me(this.checkConstraintsValidity(e,t),"Invalid constraints."),this.togetherConstraints=e,this.apartConstraints=t}},{key:"getPersonPersonKey",value:function(e,t){return JSON.stringify([e,t].sort())}},{key:"getPersonGroupKey",value:function(e,t){return JSON.stringify([e,t])}},{key:"getOccurrencesMaps",value:function(){var e,t=new Map,n=new Map,r=new Map,o=Array.from(this.personIds),s=Object(u["a"])(o.entries());try{for(s.s();!(e=s.n()).done;){var i=Object(W["a"])(e.value,2),a=i[0],l=i[1];t.set(l,0);var c,p=Object(u["a"])(o.slice(a+1));try{for(p.s();!(c=p.n()).done;){var d=c.value;if(l!=d){var v=this.getPersonPersonKey(l,d);n.set(v,{person1Id:l,person2Id:d,count:0})}}}catch($){p.e($)}finally{p.f()}var h,f=Object(u["a"])(this.groupSizes.keys());try{for(f.s();!(h=f.n()).done;){var y=h.value,g=this.getPersonGroupKey(l,y);r.set(g,{personId:l,groupId:y,count:0})}}catch($){f.e($)}finally{f.f()}}}catch($){s.e($)}finally{s.f()}var b,m=Object(u["a"])(this.history);try{for(m.s();!(b=m.n()).done;){var w,I=b.value,G=Object(u["a"])(I.entries());try{for(G.s();!(w=G.n()).done;){var P,x=Object(W["a"])(w.value,2),C=x[0],k=x[1],O=Array.from(k),M=Object(u["a"])(O.entries());try{for(M.s();!(P=M.n()).done;){var S=Object(W["a"])(P.value,2),E=S[0],j=S[1],H=t.get(j)+k.size-1;t.set(j,H);var _,B=Object(u["a"])(O.slice(E+1));try{for(B.s();!(_=B.n()).done;){var z=_.value;if(this.personIds.has(j)&&this.personIds.has(z)){var A=this.getPersonPersonKey(j,z);n.get(A).count++}}}catch($){B.e($)}finally{B.f()}var N=this.getPersonGroupKey(j,C);r.get(N).count++}}catch($){M.e($)}finally{M.f()}}}catch($){G.e($)}finally{G.f()}}}catch($){m.e($)}finally{m.f()}return[t,n,r]}},{key:"initializeEntry",value:function(e,t){var n,r=this,o=new Map,s=Object(q["a"])(this.personIds),i=Object(u["a"])(this.groupSizes.keys());try{for(i.s();!(n=i.n()).done;){var a=n.value;o.set(a,new Set)}}catch(x){i.e(x)}finally{i.f()}var l,c=Object(u["a"])(this.togetherConstraints);try{var p=function(){var e=l.value,n=Object.keys(e),i=e.personIds,a=void 0;if(n.includes("inGroup"))a=e.inGroup;else{var u=new Set(r.groupSizes.keys());if(n.includes("notInGroups")){var c=e.notInGroups;u=new Set(Array.from(u).filter((function(e){return!c.has(e)})))}var p=r.getBestGroupIdsByGroupOccurrences(i,o,t,u);me(p.size>0,"Invalid constraints."),a=ve(Array.from(p))}i.forEach((function(e){return o.get(a).add(e)})),s=s.filter((function(e){return!i.has(e)}))};for(c.s();!(l=c.n()).done;)p()}catch(x){c.e(x)}finally{c.f()}var d,v=Object(u["a"])(this.apartConstraints);try{for(v.s();!(d=v.n()).done;){var h,f=d.value,y=f.personIds,g=new Set(Array.from(o.keys()).filter((function(e){return o.get(e).size<r.groupSizes.get(e)}))),b=new Set(Array.from(g).filter((function(e){return o.get(e).size>0}))),m=Object(u["a"])(y);try{for(m.s();!(h=m.n()).done;){var w=h.value,I=void 0;if(b.size>0)I=ve(Array.from(b)),b.delete(I);else if(I=this.getGroupId(w,o),!I){var G=this.getBestGroupIdsByPersonOccurrences(new Set([w]),o,e,g);me(G.size>0,"Constraints not satisfiable."),I=ve(Array.from(G))}o.get(I).add(w);var P=s.indexOf(w);s.splice(P,1),g.delete(I)}}catch(x){m.e(x)}finally{m.f()}}}catch(x){v.e(x)}finally{v.f()}return[o,s]}},{key:"getNewEntry",value:function(){var e=this.getOccurrencesMaps(),t=Object(W["a"])(e,3),n=t[0],r=t[1],o=t[2],s=this.initializeEntry(r,o),i=Object(W["a"])(s,2),a=i[0],u=i[1];he(u),u.sort((function(e,t){return n.get(e)-n.get(t)}));var l=Array.from(r.values());he(l),l.sort((function(e,t){if(e.count<t.count)return-1;if(e.count>t.count)return 1;var r=Math.min(n.get(e.person1Id),n.get(e.person2Id)),o=Math.min(n.get(t.person1Id),n.get(t.person2Id));return r-o}));var c=this.getEmptyGroup2Id(a);while(u.length>=2&&null!=c){var p=l.shift(),d=p.person1Id,v=p.person2Id,h=u.indexOf(d),f=u.indexOf(v);-1!=h&&-1!=f&&(a.get(c).add(d),a.get(c).add(v),h<f?(u.splice(f,1),u.splice(h,1)):(u.splice(h,1),u.splice(f,1)),c=this.getEmptyGroup2Id(a))}while(this.containsNonFullNonEmptyGroup(a)&&u.length>0){var y=u.shift(),g=this.getBestGroupIdsByPersonOccurrences(new Set([y]),a,r);g.size>1&&(g=this.getBestGroupIdsByGroupOccurrences(new Set([y]),a,o,g));var b=ve(Array.from(g));a.get(b).add(y)}while(u.length>0){var m=u.shift(),w=this.getBestGroupIdsByGroupOccurrences(new Set([m]),a,o),I=ve(Array.from(w));a.get(I).add(m)}return a}},{key:"getEmptyGroup2Id",value:function(e){var t,n=this,r=he(Array.from(this.groupSizes.keys())).sort((function(e,t){return n.groupSizes.get(t)-n.groupSizes.get(e)})),o=Object(u["a"])(r);try{for(o.s();!(t=o.n()).done;){var s=t.value;if(0==e.get(s).size&&this.groupSizes.get(s)>=2)return s}}catch(i){o.e(i)}finally{o.f()}return null}},{key:"containsNonFullNonEmptyGroup",value:function(e){var t,n=Object(u["a"])(e.entries());try{for(n.s();!(t=n.n()).done;){var r=Object(W["a"])(t.value,2),o=r[0],s=r[1];if(s.size>0&&s.size<this.groupSizes.get(o))return!0}}catch(i){n.e(i)}finally{n.f()}return!1}},{key:"getGroupId",value:function(e,t){var n,r=Object(u["a"])(t.entries());try{for(r.s();!(n=r.n()).done;){var o=Object(W["a"])(n.value,2),s=o[0],i=o[1];if(i.has(e))return s}}catch(a){r.e(a)}finally{r.f()}return null}},{key:"getBestGroupIdsByPersonOccurrences",value:function(e,t,n){var r=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=new Set(this.groupSizes.keys());if(o&&!Array.from(o).some((function(e){return!s.has(e)}))||(o=s),o=new Set(Array.from(o).filter((function(n){return t.get(n).size>0&&t.get(n).size+e.size<=r.groupSizes.get(n)}))),0==o.size)return null;var i,a=new Map,l=Object(u["a"])(o);try{for(l.s();!(i=l.n()).done;){var c=i.value;a.set(c,[]);var p,d=Object(u["a"])(e);try{for(d.s();!(p=d.n()).done;){var v,h=p.value,f=Object(u["a"])(t.get(c));try{for(f.s();!(v=f.n()).done;){var y=v.value,g=this.getPersonPersonKey(h,y),b=n.get(g).count;a.get(c).push(b)}}catch(w){f.e(w)}finally{f.f()}}}catch(w){d.e(w)}finally{d.f()}}}catch(w){l.e(w)}finally{l.f()}var m=ye(Array.from(o).map((function(e){return fe(a.get(e))/a.get(e).length})));return o=new Set(Array.from(o).filter((function(e){return fe(a.get(e))/a.get(e).length==m}))),o}},{key:"getBestGroupIdsByGroupOccurrences",value:function(e,t,n){var r=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=new Set(this.groupSizes.keys());if(o&&!Array.from(o).some((function(e){return!s.has(e)}))||(o=s),o=new Set(Array.from(o).filter((function(n){return t.get(n).size+e.size<=r.groupSizes.get(n)}))),0==o.size)return null;var i,a=new Map,l=Object(u["a"])(o);try{for(l.s();!(i=l.n()).done;){var c=i.value;a.set(c,[]);var p,d=Object(u["a"])(e);try{for(d.s();!(p=d.n()).done;){var v=p.value,h=this.getPersonGroupKey(v,c);a.get(c).push(n.get(h).count)}}catch(g){d.e(g)}finally{d.f()}}}catch(g){l.e(g)}finally{l.f()}var f=ye(Array.from(o).map((function(e){return fe(a.get(e))/a.get(e).length})));o=new Set(Array.from(o).filter((function(e){return fe(a.get(e))/a.get(e).length==f})));var y=ge(Array.from(o).map((function(e){return r.groupSizes.get(e)})));return o=new Set(Array.from(o).filter((function(e){return r.groupSizes.get(e)==y}))),o}},{key:"checkEntryValidity",value:function(e){var t,n=new Set,r=Object(u["a"])(e.values());try{for(r.s();!(t=r.n()).done;){var o,s=t.value,i=Object(u["a"])(s);try{for(i.s();!(o=i.n()).done;){var a=o.value;if(n.has(a))return!1;n.add(a)}}catch(l){i.e(l)}finally{i.f()}}}catch(l){r.e(l)}finally{r.f()}return!0}},{key:"checkConstraintsValidity",value:function(e,t){if(e.length>0){var n,r=new Set(this.groupSizes.keys()),o=Object(u["a"])(e);try{for(o.s();!(n=o.n()).done;){var s,i=n.value,a=Object.keys(i),l=i.personIds,c=Object(u["a"])(l);try{for(c.s();!(s=c.n()).done;){var p=s.value;if(!this.personIds.has(p))return!1}}catch(w){c.e(w)}finally{c.f()}if(a.includes("inGroup")&&!r.has(i.inGroup))return!1;if(a.includes("notInGroups")){var d=function(){var e=i.notInGroups;if(Array.from(r).every((function(t){return e.has(t)})))return{v:!1}}();if("object"===Object(le["a"])(d))return d.v}}}catch(w){o.e(w)}finally{o.f()}}if(t.length>0){var v,h=Object(u["a"])(t);try{for(h.s();!(v=h.n()).done;){var f,y=v.value,g=y.personIds,b=Object(u["a"])(g);try{for(b.s();!(f=b.n()).done;){var m=f.value;if(!this.personIds.has(m))return!1}}catch(w){b.e(w)}finally{b.f()}}}catch(w){h.e(w)}finally{h.f()}}return!0}},{key:"saveEntry",value:function(e){me(this.checkEntryValidity(e),"Invalid entry."),this.history.push(e)}}]),e}());function ve(e){return e[Math.floor(Math.random()*e.length)]}function he(e){for(var t=e.length-1;t>0;t--){var n=Math.floor(Math.random()*(t+1)),r=[e[n],e[t]];e[t]=r[0],e[n]=r[1]}return e}function fe(e){return Array.from(e).reduce((function(e,t){return e+t}),0)}function ye(e){return Math.min.apply(Math,Object(q["a"])(e))}function ge(e){return Math.max.apply(Math,Object(q["a"])(e))}function be(e,t){return e.every(t)}function me(e,t){if(!e)throw new Error("Assertion error: "+t)}var we=de,Ie={name:"EntryPane",components:{EntryModal:ne,SaveEntryModal:ue},props:{groups:{type:Array,required:!0},persons:{type:Array,required:!0},constraints:{type:Array,required:!0},history:{type:Array,required:!0}},data:function(){return{entry:{title:null,groups:[]},entryFields:[{key:"groupId",label:"Groupe"},{key:"personIds",label:"Personnes"},{key:"updateBtn",label:""}],remainingPersons:[],generateEntryBtnHover:!1,saveEntryBtnHover:!1,updateEntryGroupBtnHover:!1,entryGroupRowHoverIndex:-1,activeIndex:-1,activeEntryGroup:null,showEntryModal:!1,showSaveEntryModal:!1}},methods:{generateEntry:function(){var e,t=new Set(this.persons.map((function(e){return e.personId}))),n=new Map(this.groups.map((function(e){return[e.groupId,e.size]}))),r=[],o=Object(u["a"])(this.history);try{for(o.s();!(e=o.n()).done;){var s,i=e.value,a=new Map,l=Object(u["a"])(i.groups);try{for(l.s();!(s=l.n()).done;){var c=s.value;a.set(c.groupId,new Set(c.persons.map((function(e){return e.personId}))))}}catch(x){l.e(x)}finally{l.f()}r.push(a)}}catch(x){o.e(x)}finally{o.f()}var p,d=[],v=[],h=Object(u["a"])(this.constraints);try{for(h.s();!(p=h.n()).done;){var f=p.value,y={personIds:new Set(f.persons.map((function(e){return e.personId})))};f.inGroup?y.inGroup=f.inGroup:f.notInGroups&&(y.notInGroups=new Set(f.notInGroups.map((function(e){return e.groupId})))),"together"==f.type?d.push(y):"apart"==f.type&&v.push(y)}}catch(x){h.e(x)}finally{h.f()}var g=new we(t,n,r,d,v),b=g.getNewEntry();this.entry={title:null,groups:[]};var m,w=Object(u["a"])(b);try{for(w.s();!(m=w.n()).done;){var I=Object(W["a"])(m.value,2),G=I[0],P=I[1];this.entry.groups.push({groupId:G,persons:Array.from(P).map((function(e){return{personId:e}}))})}}catch(x){w.e(x)}finally{w.f()}this.remainingPersons=[]},saveEntry:function(e){this.entry.title=e,this.$emit("entry-to-save",this.entry),this.entry={title:null,groups:[]},this.remainingPersons=[]},openEntryModal:function(e){this.activeIndex=e,this.activeEntryGroup=this.entry.groups[e],this.showEntryModal=!0},updateEntryGroup:function(e,t){this.entry.groups.splice(this.activeIndex,1,e),this.remainingPersons=t}}},Ge=Ie,Pe=Object(y["a"])(Ge,Q,U,!1,null,null,null),xe=Pe.exports,Ce=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e._m(0),n("div",{staticClass:"accordion",attrs:{role:"tablist"}},e._l(e.history,(function(t,r){return n("b-card",{key:r,staticClass:"mb-1",attrs:{"no-body":""}},[n("b-card-header",{staticClass:"p-1",attrs:{"header-tag":"header",role:"tab"}},[n("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:"entry"+r,expression:"'entry' + index"}],staticClass:"text-body",attrs:{block:"",variant:"link"}},[e._v(" "+e._s(t.title)+" ")])],1),n("b-collapse",{attrs:{id:"entry"+r,accordion:"historyAccordion",role:"tabpanel"}},[n("b-table",{attrs:{small:"",striped:"",hover:"",fields:e.entryFields,items:t.groups},on:{"row-hovered":function(t,n){return e.entryGroupRowHoverIndex=n},"row-unhovered":function(t,n){return e.entryGroupRowHoverIndex=-1}},scopedSlots:e._u([{key:"cell(personIds)",fn:function(t){return[e._v(" "+e._s(t.item.persons.map((function(e){return e.personId})).join(", "))+" ")]}}],null,!0)}),n("button",{directives:[{name:"b-hover",rawName:"v-b-hover",value:function(t){return e.removeEntryBtnHover=t},expression:"hover => removeEntryBtnHover = hover"}],class:"btn btn-link btn-sm "+(e.removeEntryBtnHover?"text-danger":"text-body"),on:{click:function(t){return e.removeEntry(r)}}},[e._v(" Supprimer l'entrée "),n("b-icon-x-circle")],1)],1)],1)})),1)])},ke=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"sticky-top bg-light d-inline-block w-100"},[n("span",{staticClass:"float-left h5"},[e._v("Historique")])])}],Oe={name:"HistoryPane",props:{history:{type:Array,required:!0}},data:function(){return{entryFields:[{key:"groupId",label:"Groupe"},{key:"personIds",label:"Personnes"}],removeEntryBtnHover:!1,activeEntry:null,activeEntryGroup:null,showEntryModal:!1}},methods:{removeEntry:function(e){this.$emit("entry-to-remove",e)}}},Me=Oe,Se=Object(y["a"])(Me,Ce,ke,!1,null,null,null),Ee=Se.exports,je="MemoMix--",He="default";function _e(e){return je+e+"--Groups"}function Be(e){return je+e+"--Persons"}function ze(e){return je+e+"--Constraints"}function Ae(e){return je+e+"--History"}function Ne(){return je+"CurrentProject"}function $e(){return je+"Projects"}var qe={name:"App",components:{Splitpanes:l["Splitpanes"],Pane:l["Pane"],GroupPane:G,PersonPane:B,ConstraintPane:L,EntryPane:xe,HistoryPane:Ee},data:function(){return{currentProject:null,projects:[],groups:[],persons:[],constraints:[],history:[]}},mounted:function(){this.currentProject=localStorage.getItem(Ne()),null==this.currentProject?(this.currentProject=He,localStorage.setItem(Ne(),He),localStorage.setItem($e(),JSON.stringify([He])),this.saveGroups(),this.savePersons(),this.saveConstraints(),this.saveHistory()):this.switchProject(this.currentProject)},methods:{updateGroup:function(e,t,n){var r,o=this.groups[e].groupId,s=t.groupId,i=Object(u["a"])(this.constraints);try{for(i.s();!(r=i.n()).done;){var a=r.value;a.inGroup==o&&(a.inGroup=s);var l=a.notInGroups.find((function(e){var t=e.groupId;return t==o}));l&&(l.groupId=s)}}catch(y){i.e(y)}finally{i.f()}if(this.saveGroups(),n){var c,p=Object(u["a"])(this.history);try{for(p.s();!(c=p.n()).done;){var d,v=c.value,h=Object(u["a"])(v.groups);try{for(h.s();!(d=h.n()).done;){var f=d.value;f.groupId==o&&(f.groupId=s)}}catch(y){h.e(y)}finally{h.f()}}}catch(y){p.e(y)}finally{p.f()}this.saveHistory()}this.groups.splice(e,1,t)},addGroup:function(e){this.groups.push(e),this.saveGroups()},removeGroup:function(e){this.groups.splice(e,1),this.saveGroups()},updatePerson:function(e,t,n){var r,o=this.persons[e].personId,s=t.personId,i=Object(u["a"])(this.constraints);try{for(i.s();!(r=i.n()).done;){var a=r.value,l=a.persons.find((function(e){var t=e.personId;return t==o}));l&&(l.personId=s)}}catch(m){i.e(m)}finally{i.f()}if(this.savePersons(),n){var c,p=Object(u["a"])(this.history);try{for(p.s();!(c=p.n()).done;){var d,v=c.value,h=Object(u["a"])(v.groups);try{for(h.s();!(d=h.n()).done;){var f,y=d.value,g=Object(u["a"])(y.persons);try{for(g.s();!(f=g.n()).done;){var b=f.value;b.personId==o&&(b.personId=s)}}catch(m){g.e(m)}finally{g.f()}}}catch(m){h.e(m)}finally{h.f()}}}catch(m){p.e(m)}finally{p.f()}this.saveHistory()}this.persons.splice(e,1,t)},addPerson:function(e){this.persons.push(e),this.savePersons()},removePerson:function(e){this.persons.splice(e,1),this.savePersons()},updateConstraint:function(e,t){this.constraints.splice(e,1,t),this.saveConstraints()},addConstraint:function(e){this.constraints.push(e),this.saveConstraints()},removeConstraint:function(e){this.constraints.splice(e,1),this.saveConstraints()},saveEntry:function(e){this.history.push(e),this.saveHistory()},removeEntry:function(e){this.history.splice(e,1),this.saveHistory()},switchProject:function(e){this.groups=JSON.parse(localStorage.getItem(_e(e))),this.persons=JSON.parse(localStorage.getItem(Be(e))),this.constraints=JSON.parse(localStorage.getItem(ze(e))),this.history=JSON.parse(localStorage.getItem(Ae(e))),this.currentProject=e},saveGroups:function(){localStorage.setItem(_e(this.currentProject),JSON.stringify(this.groups))},savePersons:function(){localStorage.setItem(Be(this.currentProject),JSON.stringify(this.persons))},saveConstraints:function(){localStorage.setItem(ze(this.currentProject),JSON.stringify(this.constraints))},saveHistory:function(){localStorage.setItem(Ae(this.currentProject),JSON.stringify(this.history))}}},Re=qe,Te=(n("034f"),Object(y["a"])(Re,i,a,!1,null,null,null)),Fe=Te.exports;r["default"].use(o["a"]),r["default"].use(s["a"]),new r["default"]({el:"#app",render:function(e){return e(Fe)}})},"85ec":function(e,t,n){}});
//# sourceMappingURL=app.6cf9a36e.js.map