(function(e){function t(t){for(var r,i,a=t[0],u=t[1],l=t[2],p=0,d=[];p<a.length;p++)i=a[p],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&d.push(o[i][0]),o[i]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(e[r]=u[r]);c&&c(t);while(d.length)d.shift()();return s.push.apply(s,l||[]),n()}function n(){for(var e,t=0;t<s.length;t++){for(var n=s[t],r=!0,a=1;a<n.length;a++){var u=n[a];0!==o[u]&&(r=!1)}r&&(s.splice(t--,1),e=i(i.s=n[0]))}return e}var r={},o={index:0},s=[];function i(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/memomix/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],u=a.push.bind(a);a.push=t,a=a.slice();for(var l=0;l<a.length;l++)t(a[l]);var c=u;s.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";n("85ec")},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("2b0e"),o=n("1ad5"),s=n("39ba"),i=(n("f9e3"),n("2dd8"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("splitpanes",{staticClass:"default-theme",staticStyle:{height:"100vh"},attrs:{horizontal:""}},[n("pane",{staticClass:"horizontalPane"},[n("splitpanes",{attrs:{vertical:""}},[n("pane",[n("group-pane",{attrs:{groups:e.groups},on:{"group-to-update":e.updateGroup,"group-to-add":e.addGroup,"group-to-remove":e.removeGroup}})],1),n("pane",[n("person-pane",{attrs:{persons:e.persons},on:{"person-to-update":e.updatePerson,"person-to-add":e.addPerson,"person-to-remove":e.removePerson}})],1),n("pane",[n("constraint-pane",{attrs:{constraints:e.constraints,persons:e.persons,groups:e.groups},on:{"constraint-to-update":e.updateConstraint,"constraint-to-add":e.addConstraint,"constraint-to-remove":e.removeConstraint}})],1)],1)],1),n("pane",{staticClass:"horizontalPane"},[n("splitpanes",[n("pane",[n("history-pane",{attrs:{history:e.history},on:{"entry-to-remove":e.removeEntry}})],1),n("pane",[n("entry-pane",{attrs:{groups:e.groups,persons:e.persons,constraints:e.constraints,history:e.history},on:{"entry-to-save":e.saveEntry}})],1)],1)],1)],1)],1)}),a=[],u=n("b85c"),l=(n("a434"),n("7db0"),n("512e")),c=(n("c1ea"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("group-modal",{attrs:{"old-group":e.activeGroup,groups:e.groups},on:{"group-to-update":function(t,n){return e.updateGroup(e.activeIndex,t,n)},"group-to-add":function(t){return e.addGroup(t)},"group-to-remove":function(){return e.removeGroup(e.activeIndex)}},model:{value:e.showGroupModal,callback:function(t){e.showGroupModal=t},expression:"showGroupModal"}}),n("div",{staticClass:"sticky-top bg-light d-inline-block w-100"},[n("span",{staticClass:"float-left h5"},[e._v("Groupes")]),n("span",{staticClass:"float-right"},[n("button",{directives:[{name:"b-hover",rawName:"v-b-hover",value:function(t){return e.addGroupBtnHover=t},expression:"hover => addGroupBtnHover = hover"}],class:"btn btn-link btn-sm "+(e.addGroupBtnHover?"text-success":"text-body"),on:{click:function(t){return e.openGroupModal(-1)}}},[e._v(" Nouveau groupe "),n("b-icon-plus-circle")],1)])]),n("b-table",{attrs:{small:"",striped:"",hover:"",fields:e.groupFields,items:e.groups},on:{"row-hovered":function(t,n){return e.groupRowHoverIndex=n},"row-unhovered":function(t,n){return e.groupRowHoverIndex=-1}},scopedSlots:e._u([{key:"cell(updateBtn)",fn:function(t){return[n("div",{staticClass:"float-right"},[n("button",{directives:[{name:"b-hover",rawName:"v-b-hover",value:function(t){return e.updateGroupBtnHover=t},expression:"hover => updateGroupBtnHover = hover"}],class:"btn btn-link btn-sm"+(e.updateGroupBtnHover?" text-success":" text-body")+(e.groupRowHoverIndex==t.index?" visible":" invisible"),on:{click:function(n){return e.openGroupModal(t.index)}}},[n("b-icon-pencil")],1)])]}}])})],1)}),p=[],d=n("29a1"),h=n("7386"),v=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("b-modal",{attrs:{title:e.modalTitle},on:{show:e.reinitGroupModal,hide:e.reinitGroupModal},scopedSlots:e._u([{key:"default",fn:function(){return[n("b-form",{attrs:{novalidate:""},on:{submit:function(e){return e.preventDefault()}}},[n("b-form-group",{attrs:{label:"Identifiant du groupe","label-for":"groupId"}},[n("b-form-input",{attrs:{type:"text",state:!e.groupIdConflict&&null,required:"",maxlength:"32",placeholder:"Identifiant du groupe (e.g. nom d'une tâche) "},model:{value:e.newGroup.groupId,callback:function(t){e.$set(e.newGroup,"groupId","string"===typeof t?t.trim():t)},expression:"newGroup.groupId"}}),n("div",{staticClass:"invalid-feedback"},[e._v(" Le groupe existe déjà. ")])],1),n("b-form-group",{attrs:{label:"Taille du groupe","label-for":"size"}},[n("b-form-input",{attrs:{type:"number",required:""},model:{value:e.newGroup.size,callback:function(t){e.$set(e.newGroup,"size",e._n(t))},expression:"newGroup.size"}})],1),e.isCreationModal?e._e():n("b-form-checkbox",{attrs:{switch:""},model:{value:e.updateHistory,callback:function(t){e.updateHistory=t},expression:"updateHistory"}},[e._v(" Modifier les occurrences du groupe dans l'historique ")])],1)]},proxy:!0},{key:"modal-footer",fn:function(){return[n("b-button",{attrs:{variant:"success"},on:{click:e.checkGroup}},[e._v(" Valider "),n("b-icon-check-circle")],1),e.isCreationModal?e._e():n("b-button",{attrs:{variant:"danger"},on:{click:e.removeGroup}},[e._v(" Supprimer "),n("b-icon-x-circle")],1)]},proxy:!0}]),model:{value:e.showGroupModal,callback:function(t){e.showGroupModal=t},expression:"showGroupModal"}})],1)},f=[],y=n("6aac"),m=n("1947"),g=n("11de"),b=n("8226"),w=n("4797"),I=n("c3e6"),G={name:"GroupModal",components:{BModal:y["a"],BButton:m["a"],BForm:g["a"],BFormGroup:b["a"],BFormInput:w["a"],BFormCheckbox:I["a"],BIconXCircle:h["e"],BIconCheckCircle:h["a"]},props:{value:{type:Boolean,required:!0},oldGroup:{type:Object},groups:{type:Array,required:!0}},data:function(){return{newGroup:this.generateNewGroup(),updateHistory:!0}},methods:{generateNewGroup:function(){return this.oldGroup?{groupId:this.oldGroup.groupId,size:this.oldGroup.size}:{groupId:"",size:1}},reinitGroupModal:function(){this.newGroup=this.generateNewGroup(),this.updateHistory=!0},updateGroup:function(){this.$emit("group-to-update",this.newGroup,this.updateHistory),this.showGroupModal=!1},addGroup:function(){this.$emit("group-to-add",this.newGroup),this.showGroupModal=!1},removeGroup:function(){this.$emit("group-to-remove"),this.showGroupModal=!1},checkGroup:function(){var e=!this.groupIdConflict&&this.newGroup.groupId.length>=1;e&&(this.isCreationModal?this.addGroup():this.updateGroup())}},computed:{showGroupModal:{get:function(){return this.value},set:function(e){return this.$emit("input",e)}},isCreationModal:function(){return null==this.oldGroup},modalTitle:function(){return this.isCreationModal?"Ajouter un groupe":"Modifier le groupe"},groupIdConflict:function(){var e=this,t=this.groups.find((function(t){return t.groupId==e.newGroup.groupId}));if(void 0==t)return!1;if(this.isCreationModal)return!0;var n=this.oldGroup.groupId,r=t.groupId;return n!=r}}},P=G,C=n("2877"),x=Object(C["a"])(P,v,f,!1,null,null,null),k=x.exports,B={name:"GroupPane",components:{BTable:d["a"],BIconPlusCircle:h["d"],BIconPencil:h["b"],GroupModal:k},props:{groups:{type:Array,required:!0}},data:function(){return{groupFields:[{key:"groupId",label:"ID"},{key:"size",label:"Taille"},{key:"updateBtn",label:""}],addGroupBtnHover:!1,updateGroupBtnHover:!1,groupRowHoverIndex:-1,activeIndex:-1,activeGroup:null,showGroupModal:!1}},methods:{updateGroup:function(e,t,n){this.$emit("group-to-update",e,t,n)},addGroup:function(e){this.$emit("group-to-add",e)},removeGroup:function(e){this.$emit("group-to-remove",e),this.updateGroupBtnHover=!1},openGroupModal:function(e){this.activeIndex=e,this.activeGroup=-1==e?null:this.groups[e],this.showGroupModal=!0}}},M=B,O=Object(C["a"])(M,c,p,!1,null,null,null),S=O.exports,E=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("person-modal",{attrs:{"old-person":e.activePerson,persons:e.persons},on:{"person-to-update":function(t,n){return e.updatePerson(e.activeIndex,t,n)},"person-to-add":function(t){return e.addPerson(t)},"person-to-remove":function(){return e.removePerson(e.activeIndex)}},model:{value:e.showPersonModal,callback:function(t){e.showPersonModal=t},expression:"showPersonModal"}}),n("div",{staticClass:"sticky-top bg-light d-inline-block w-100"},[n("span",{staticClass:"float-left h5"},[e._v("Personnes")]),n("span",{staticClass:"float-right"},[n("button",{directives:[{name:"b-hover",rawName:"v-b-hover",value:function(t){return e.addPersonBtnHover=t},expression:"hover => addPersonBtnHover = hover"}],class:"btn btn-link btn-sm "+(e.addPersonBtnHover?"text-success":"text-body"),on:{click:function(t){return e.openPersonModal(-1)}}},[e._v(" Nouvelle personne "),n("b-icon-plus-circle")],1)])]),n("b-table",{attrs:{small:"",striped:"",hover:"",fields:e.personFields,items:e.persons},on:{"row-hovered":function(t,n){return e.personRowHoverIndex=n},"row-unhovered":function(t,n){return e.personRowHoverIndex=-1}},scopedSlots:e._u([{key:"cell(updateBtn)",fn:function(t){return[n("div",{staticClass:"float-right"},[n("button",{directives:[{name:"b-hover",rawName:"v-b-hover",value:function(t){return e.updatePersonBtnHover=t},expression:"hover => updatePersonBtnHover = hover"}],class:"btn btn-link btn-sm"+(e.updatePersonBtnHover?" text-success":" text-body")+(e.personRowHoverIndex==t.index?" visible":" invisible"),on:{click:function(n){return e.openPersonModal(t.index)}}},[n("b-icon-pencil")],1)])]}}])})],1)},j=[],H=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("b-modal",{attrs:{title:e.modalTitle},on:{show:e.reinitPersonModal,hide:e.reinitPersonModal},scopedSlots:e._u([{key:"default",fn:function(){return[n("b-form",{attrs:{novalidate:""},on:{submit:function(e){return e.preventDefault()}}},[n("b-form-group",{attrs:{label:"Identifiant de la personne","label-for":"personId"}},[n("b-form-input",{attrs:{type:"text",state:!e.personIdConflict&&null,required:"",maxlength:"32",placeholder:"Identifiant de la personne (e.g. Prénom + Nom)"},model:{value:e.newPerson.personId,callback:function(t){e.$set(e.newPerson,"personId","string"===typeof t?t.trim():t)},expression:"newPerson.personId"}}),n("div",{staticClass:"invalid-feedback"},[e._v(" La personne existe déjà. ")])],1),e.isCreationModal?e._e():n("b-form-checkbox",{attrs:{switch:""},model:{value:e.updateHistory,callback:function(t){e.updateHistory=t},expression:"updateHistory"}},[e._v(" Modifier les occurrences de la personne dans l'historique ")])],1)]},proxy:!0},{key:"modal-footer",fn:function(){return[n("b-button",{attrs:{variant:"success"},on:{click:e.checkPerson}},[e._v(" Valider "),n("b-icon-check-circle")],1),e.isCreationModal?e._e():n("b-button",{attrs:{variant:"danger"},on:{click:e.removePerson}},[e._v(" Supprimer "),n("b-icon-x-circle")],1)]},proxy:!0}]),model:{value:e.showPersonModal,callback:function(t){e.showPersonModal=t},expression:"showPersonModal"}})],1)},_=[],z={name:"PersonModal",components:{BModal:y["a"],BButton:m["a"],BForm:g["a"],BFormGroup:b["a"],BFormInput:w["a"],BFormCheckbox:I["a"],BIconXCircle:h["e"],BIconCheckCircle:h["a"]},props:{value:{type:Boolean,required:!0},oldPerson:{type:Object},persons:{type:Array,required:!0}},data:function(){return{newPerson:this.generateNewPerson(),updateHistory:!1}},methods:{generateNewPerson:function(){return this.oldPerson?{personId:this.oldPerson.personId}:{personId:""}},reinitPersonModal:function(){this.newPerson=this.generateNewPerson(),this.updateHistory=!0},updatePerson:function(){this.$emit("person-to-update",this.newPerson,this.updateHistory),this.showPersonModal=!1},addPerson:function(){this.$emit("person-to-add",this.newPerson),this.showPersonModal=!1},removePerson:function(){this.$emit("person-to-remove"),this.showPersonModal=!1},checkPerson:function(){var e=!this.personIdConflict&&this.newPerson.personId.length>=1;e&&(this.isCreationModal?this.addPerson():this.updatePerson())}},computed:{showPersonModal:{get:function(){return this.value},set:function(e){return this.$emit("input",e)}},isCreationModal:function(){return null==this.oldPerson},modalTitle:function(){return this.isCreationModal?"Ajouter une personne":"Modifier la personne"},personIdConflict:function(){var e=this,t=this.persons.find((function(t){return t.personId==e.newPerson.personId}));if(void 0==t)return!1;if(this.isCreationModal)return!0;var n=this.oldPerson.personId,r=t.personId;return n!=r}}},A=z,$=Object(C["a"])(A,H,_,!1,null,null,null),N=$.exports,T={name:"PersonPane",components:{BTable:d["a"],BIconPlusCircle:h["d"],BIconPencil:h["b"],PersonModal:N},props:{persons:{type:Array,required:!0}},data:function(){return{personFields:[{key:"personId",label:"ID"},{key:"updateBtn",label:""}],addPersonBtnHover:!1,updatePersonBtnHover:!1,personRowHoverIndex:-1,activeIndex:-1,activePerson:null,showPersonModal:!1}},methods:{updatePerson:function(e,t,n){this.$emit("person-to-update",e,t,n)},addPerson:function(e){this.$emit("person-to-add",e)},removePerson:function(e){this.$emit("person-to-remove",e),this.updatePersonBtnHover=!1},openPersonModal:function(e){this.activeIndex=e,this.activePerson=-1==e?null:this.persons[e],this.showPersonModal=!0}}},F=T,R=Object(C["a"])(F,E,j,!1,null,null,null),q=R.exports,J=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("constraint-modal",{attrs:{"old-constraint":e.activeConstraint,groups:e.groups,persons:e.persons},on:{"constraint-to-update":function(t){return e.updateConstraint(e.activeIndex,t)},"constraint-to-add":function(t){return e.addConstraint(t)},"constraint-to-remove":function(t){return e.removeConstraint(e.activeIndex)}},model:{value:e.showConstraintModal,callback:function(t){e.showConstraintModal=t},expression:"showConstraintModal"}}),n("div",{staticClass:"sticky-top bg-light d-inline-block w-100"},[n("span",{staticClass:"float-left h5"},[e._v("Contraintes")]),n("span",{staticClass:"float-right"},[n("button",{directives:[{name:"b-hover",rawName:"v-b-hover",value:function(t){return e.addConstraintBtnHover=t},expression:"hover => addConstraintBtnHover = hover"}],class:"btn btn-link btn-sm "+(e.addConstraintBtnHover?"text-success":"text-body"),on:{click:e.openConstraintModal}},[e._v(" Nouvelle contrainte "),n("b-icon-plus-circle")],1)])]),n("b-table",{attrs:{small:"",striped:"",hover:"",fields:e.constraintFields,items:e.constraints},on:{"row-hovered":function(t,n){return e.constraintRowHoverIndex=n},"row-unhovered":function(t,n){return e.constraintRowHoverIndex=-1}},scopedSlots:e._u([{key:"cell(type)",fn:function(t){return[e._v(" "+e._s(e.constraintTypes[t.item.type])+" ")]}},{key:"cell(personIds)",fn:function(t){return[e._v(" "+e._s(t.item.persons.map((function(e){return e.personId})).join(", "))+" ")]}},{key:"cell(updateBtn)",fn:function(t){return[n("div",{staticClass:"float-right"},[n("button",{directives:[{name:"b-hover",rawName:"v-b-hover",value:function(t){return e.updateConstraintBtnHover=t},expression:"hover => updateConstraintBtnHover = hover"}],class:"btn btn-link btn-sm"+(e.updateConstraintBtnHover?" text-success":" text-body")+(e.constraintRowHoverIndex==t.index?" visible":" invisible"),on:{click:function(n){return e.openConstraintModal(t.index)}}},[n("b-icon-pencil")],1)])]}}])})],1)},V=[],D=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("b-modal",{attrs:{title:e.modalTitle},on:{show:e.reinitConstraintModal,hide:e.reinitConstraintModal},scopedSlots:e._u([{key:"default",fn:function(){return[e.newConstraint?n("div",[n("b-form-group",{attrs:{label:"Type","label-for":"type"}},[n("b-form-select",{attrs:{options:e.typeOptions,id:"type"},model:{value:e.newConstraint.type,callback:function(t){e.$set(e.newConstraint,"type",t)},expression:"newConstraint.type"}})],1),n("b-form-group",{attrs:{label:"Ajouter une personne","label-for":"newPerson"}},[n("b-form-select",{attrs:{options:e.personOptions,id:"newPerson"},on:{change:function(t){return e.addPerson(t)}},scopedSlots:e._u([{key:"first",fn:function(){return[n("b-form-select-option",{attrs:{value:"",disabled:""}},[e._v("-- Sélectionner une personne --")])]},proxy:!0}],null,!1,4021855126),model:{value:e.reinitSelectPerson,callback:function(t){e.reinitSelectPerson=t},expression:"reinitSelectPerson"}})],1),e.newConstraint.persons.length>=1?n("div",[n("b-table",{attrs:{small:"",striped:"",hover:"",fields:e.personFields,items:e.newConstraint.persons},on:{"row-hovered":function(t,n){return e.personRowHoverIndex=n},"row-unhovered":function(t,n){return e.personRowHoverIndex=-1}},scopedSlots:e._u([{key:"cell(removeBtn)",fn:function(t){return[n("div",{staticClass:"float-right"},[n("button",{directives:[{name:"b-hover",rawName:"v-b-hover",value:function(t){return e.removePersonBtnHover=t},expression:"hover => removePersonBtnHover = hover"}],class:"btn btn-link btn-sm"+(e.removePersonBtnHover?" text-danger":" text-body")+(e.personRowHoverIndex==t.index?" visible":" invisible"),on:{click:function(n){return e.removePerson(t.index)}}},[n("b-icon-x-circle")],1)])]}}],null,!1,4039853407)})],1):e._e(),"together"==e.newConstraint.type?n("div",[n("b-form-group",{attrs:{label:"Dans le groupe","label-for":"mandatoryGroup"}},[n("b-form-select",{attrs:{options:e.groupOptions,id:"mandatoryGroup",disabled:e.newConstraint.forbiddenGroups.length>=1},scopedSlots:e._u([{key:"first",fn:function(){return[n("b-select-option",{attrs:{value:null}})]},proxy:!0}],null,!1,26767175),model:{value:e.newConstraint.mandatoryGroup,callback:function(t){e.$set(e.newConstraint,"mandatoryGroup",t)},expression:"newConstraint.mandatoryGroup"}})],1),n("b-form-group",{attrs:{label:"Pas dans les groupes","label-for":"forbiddenGroups"}},[n("b-form-select",{attrs:{options:e.groupOptions,id:"forbiddenGroups",disabled:null!=e.newConstraint.mandatoryGroup},on:{change:function(t){return e.addGroup(t)}},scopedSlots:e._u([{key:"first",fn:function(){return[n("b-form-select-option",{attrs:{value:"",disabled:""}},[e._v("-- Sélectionner un groupe --")])]},proxy:!0}],null,!1,2889731287),model:{value:e.reinitSelectGroup,callback:function(t){e.reinitSelectGroup=t},expression:"reinitSelectGroup"}})],1),e.newConstraint.forbiddenGroups.length>=1?n("div",[n("b-table",{attrs:{small:"",striped:"",hover:"",fields:e.groupFields,items:e.newConstraint.forbiddenGroups},scopedSlots:e._u([{key:"cell(removeBtn)",fn:function(t){return[n("div",{staticClass:"float-right"},[n("button",{directives:[{name:"b-hover",rawName:"v-b-hover",value:function(t){return e.removeGroupBtnHover=t},expression:"hover => removeGroupBtnHover = hover"}],class:"btn btn-link btn-sm"+(e.removeGroupBtnHover?" text-danger":" text-body")+(e.groupRowHoverIndex==t.index?" visible":" invisible"),on:{click:function(n){return e.removeGroup(t.index)}}},[n("b-icon-x-circle")],1)])]}}],null,!1,1387577813)})],1):e._e()],1):e._e()],1):e._e()]},proxy:!0},{key:"modal-footer",fn:function(){return[n("b-button",{attrs:{variant:"success"},on:{click:e.checkConstraint}},[e._v(" Valider "),n("b-icon-check-circle")],1),e.isCreationModal?e._e():n("b-button",{attrs:{variant:"danger"},on:{click:e.removeConstraint}},[e._v(" Supprimer "),n("b-icon-x-circle")],1)]},proxy:!0}]),model:{value:e.showConstraintModal,callback:function(t){e.showConstraintModal=t},expression:"showConstraintModal"}})],1)},X=[],L=n("2909"),W=n("8361"),K=n("ea4c"),Q={name:"ConstraintModal",components:{BModal:y["a"],BButton:m["a"],BTable:d["a"],BFormGroup:b["a"],BFormSelect:W["a"],BFormSelectOption:K["a"],BIconXCircle:h["e"],BIconCheckCircle:h["a"]},props:{value:{type:Boolean,required:!0},oldConstraint:{type:Object},persons:{type:Array,required:!0},groups:{type:Array,required:!0}},data:function(){return{newConstraint:this.generateNewConstraint(),typeOptions:[{value:"apart",text:"Séparés"},{value:"together",text:"Ensemble"}],personOptions:this.generatePersonOptions(),personFields:[{key:"personId",label:"Personnes"},{key:"removeBtn",label:""}],groupOptions:this.generateGroupOptions(),groupFields:[{key:"groupId",label:"Groupes interdits"},{key:"removeBtn",label:""}],removePersonBtnHover:!1,personRowHoverIndex:-1,removeGroupBtnHover:!1,groupRowHoverIndex:-1,reinitSelectPerson:null,reinitSelectGroup:null}},methods:{generateNewConstraint:function(){return this.oldConstraint?{type:this.oldConstraint.type,persons:Object(L["a"])(this.oldConstraint.persons),mandatoryGroup:this.oldConstraint.mandatoryGroup,forbiddenGroups:Object(L["a"])(this.oldConstraint.forbiddenGroups)}:{type:"apart",persons:[],mandatoryGroup:null,forbiddenGroups:[]}},reinitConstraintModal:function(){this.newConstraint=this.generateNewConstraint(),this.personOptions=this.generatePersonOptions(),this.groupOptions=this.generateGroupOptions()},updateConstraint:function(){this.$emit("constraint-to-update",this.newConstraint),this.showConstraintModal=!1},addConstraint:function(){this.$emit("constraint-to-add",this.newConstraint),this.showConstraintModal=!1},removeConstraint:function(){this.$emit("constraint-to-remove"),this.showConstraintModal=!1},addPerson:function(e){this.newConstraint.persons.push({personId:e}),this.personOptions=this.generatePersonOptions()},removePerson:function(e){var t=this.newConstraint.persons[e].personId;this.newConstraint.persons.splice(e,1),this.personOptions.push({value:t,text:t}),this.reinitSelectPerson=null,this.removePersonBtnHover=!1},addGroup:function(e){this.newConstraint.forbiddenGroups.push({groupId:e}),this.groupOptions=this.generateGroupOptions()},removeGroup:function(e){this.newConstraint.forbiddenGroups.splice(e,1),this.groupOptions=this.generateGroupOptions(),this.reinitSelectGroup=null,this.removeGroupBtnHover=!1},generatePersonOptions:function(){var e=this,t=[];if(this.newConstraint){var n,r=Object(u["a"])(this.persons);try{var o=function(){var r=n.value;e.newConstraint.persons.every((function(e){var t=e.personId;return t!=r.personId}))&&t.push({value:r.personId,text:r.personId})};for(r.s();!(n=r.n()).done;)o()}catch(s){r.e(s)}finally{r.f()}}return t},generateGroupOptions:function(){var e=this,t=[];if(this.newConstraint){var n,r=Object(u["a"])(this.groups);try{var o=function(){var r=n.value;e.newConstraint.forbiddenGroups.every((function(e){var t=e.groupId;return t!=r.groupId}))&&t.push({value:r.groupId,text:r.groupId})};for(r.s();!(n=r.n()).done;)o()}catch(s){r.e(s)}finally{r.f()}}return t},checkConstraint:function(){var e=this.newConstraint.persons.length>=1;e&&(this.isCreationModal?this.addConstraint():this.updateConstraint())}},watch:{persons:function(){this.personOptions=this.generatePersonOptions()},groups:function(){this.groupOptions=this.generateGroupOptions()}},computed:{showConstraintModal:{get:function(){return this.value},set:function(e){return this.$emit("input",e)}},isCreationModal:function(){return null==this.oldConstraint},modalTitle:function(){return this.isCreationModal?"Ajouter une contrainte":"Modifier la contrainte"}}},U=Q,Y=Object(C["a"])(U,D,X,!1,null,null,null),Z=Y.exports,ee={name:"ConstraintPane",components:{BTable:d["a"],BIconPlusCircle:h["d"],BIconPencil:h["b"],ConstraintModal:Z},props:{constraints:{type:Array,required:!0},persons:{type:Array,required:!0},groups:{type:Array,required:!0}},data:function(){return{constraintFields:[{key:"type",label:"Type"},{key:"personIds",label:"Personnes"},{key:"updateBtn",label:""}],addConstraintBtnHover:!1,updateConstraintBtnHover:!1,constraintRowHoverIndex:-1,activeIndex:-1,activeConstraint:null,showConstraintModal:!1,constraintTypes:{apart:"Séparés",together:"Ensemble"}}},methods:{updateConstraint:function(e,t){this.$emit("constraint-to-update",e,t)},addConstraint:function(e){this.$emit("constraint-to-add",e)},removeConstraint:function(e){this.$emit("constraint-to-remove",e),this.removeConstraintHover=-1},openConstraintModal:function(e){this.activeIndex=e,this.activeConstraint=-1==e?null:this.constraints[e],this.showConstraintModal=!0}},watch:{persons:{deep:!0,handler:function(){}}}},te=ee,ne=Object(C["a"])(te,J,V,!1,null,null,null),re=ne.exports,oe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("entry-modal",{attrs:{"remaining-persons":e.remainingPersons,"old-entry-group":e.activeEntryGroup},on:{"entry-group-to-update":e.updateEntryGroup},model:{value:e.showEntryModal,callback:function(t){e.showEntryModal=t},expression:"showEntryModal"}}),n("save-entry-modal",{attrs:{"remaining-persons":e.remainingPersons},on:{"entry-to-save":e.saveEntry},model:{value:e.showSaveEntryModal,callback:function(t){e.showSaveEntryModal=t},expression:"showSaveEntryModal"}}),n("div",{staticClass:"sticky-top bg-light d-inline-block w-100"},[n("span",{staticClass:"float-left h5"},[e._v("Proposition")]),n("span",{staticClass:"float-right"},[e.entry.groups.length>0?n("button",{directives:[{name:"b-hover",rawName:"v-b-hover",value:function(t){return e.saveEntryBtnHover=t},expression:"hover => saveEntryBtnHover = hover"}],class:"btn btn-link btn-sm "+(e.saveEntryBtnHover?"text-success":"text-body"),on:{click:function(t){e.showSaveEntryModal=!0}}},[e._v(" Sauvegarder "),n("b-icon-check-circle")],1):e._e(),n("button",{directives:[{name:"b-hover",rawName:"v-b-hover",value:function(t){return e.generateEntryBtnHover=t},expression:"hover => generateEntryBtnHover = hover"}],class:"btn btn-link btn-sm "+(e.generateEntryBtnHover?"text-primary":"text-body"),on:{click:e.generateEntry}},[e._v(" Générer "),n("b-icon-play-circle")],1)])]),n("b-table",{attrs:{small:"",striped:"",hover:"",fields:e.entryFields,items:e.entry.groups},on:{"row-hovered":function(t,n){return e.entryGroupRowHoverIndex=n},"row-unhovered":function(t,n){return e.entryGroupRowHoverIndex=-1}},scopedSlots:e._u([{key:"cell(personIds)",fn:function(t){return[e._v(" "+e._s(t.item.persons.map((function(e){return e.personId})).join(", "))+" ")]}},{key:"cell(updateBtn)",fn:function(t){return[n("div",{staticClass:"float-right"},[n("button",{directives:[{name:"b-hover",rawName:"v-b-hover",value:function(t){return e.updateEntryGroupBtnHover=t},expression:"hover => updateEntryGroupBtnHover = hover"}],class:"btn btn-link btn-sm"+(e.updateEntryGroupBtnHover?" text-success":" text-body")+(e.entryGroupRowHoverIndex==t.index?" visible":" invisible"),on:{click:function(n){return e.openEntryModal(t.index)}}},[n("b-icon-pencil")],1)])]}}])}),e.remainingPersons.length>=1?n("p",[n("span",{staticClass:"font-italic font-weight-bold"},[e._v("Personnes restantes :")]),e._v(" "+e._s(e.remainingPersons.map((function(e){return e.personId})).join(", "))+" ")]):e._e()],1)},se=[],ie=n("3835"),ae=(n("6062"),n("d3b7"),n("3ca3"),n("ddb0"),n("d81d"),n("4ec9"),n("b64b"),n("caad"),n("2532"),n("a630"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("b-modal",{attrs:{title:e.modalTitle},on:{show:e.reinitEntryModal,hide:e.reinitEntryModal},scopedSlots:e._u([{key:"default",fn:function(){return[e.newEntryGroup?n("div",[n("b-form-group",{attrs:{label:"Ajouter une personne","label-for":"newPerson"}},[n("b-form-select",{attrs:{options:e.personOptions,id:"newPerson"},on:{change:function(t){return e.addPerson(t)}},scopedSlots:e._u([{key:"first",fn:function(){return[n("b-form-select-option",{attrs:{value:"",disabled:""}},[e._v("-- Sélectionner une personne --")])]},proxy:!0}],null,!1,4021855126),model:{value:e.reinitSelectPerson,callback:function(t){e.reinitSelectPerson=t},expression:"reinitSelectPerson"}})],1),e.newEntryGroup.persons.length>=1?n("div",[n("b-table",{attrs:{small:"",striped:"",hover:"",fields:e.personFields,items:e.newEntryGroup.persons},on:{"row-hovered":function(t,n){return e.personRowHoverIndex=n},"row-unhovered":function(t,n){return e.personRowHoverIndex=-1}},scopedSlots:e._u([{key:"cell(removeBtn)",fn:function(t){return[n("div",{staticClass:"float-right"},[n("button",{directives:[{name:"b-hover",rawName:"v-b-hover",value:function(t){return e.removePersonBtnHover=t},expression:"hover => removePersonBtnHover = hover"}],class:"btn btn-link btn-sm"+(e.removePersonBtnHover?" text-danger":" text-body")+(e.personRowHoverIndex==t.index?" visible":" invisible"),on:{click:function(n){return e.removePerson(t.index)}}},[n("b-icon-x-circle")],1)])]}}],null,!1,4039853407)})],1):e._e()],1):e._e()]},proxy:!0},{key:"modal-footer",fn:function(){return[n("b-button",{attrs:{variant:"success"},on:{click:e.checkEntryGroup}},[e._v(" Valider "),n("b-icon-check-circle")],1)]},proxy:!0}]),model:{value:e.showEntryModal,callback:function(t){e.showEntryModal=t},expression:"showEntryModal"}})],1)}),ue=[],le={name:"EntryModal",components:{BModal:y["a"],BFormGroup:b["a"],BFormSelect:W["a"],BIconXCircle:h["e"],BIconCheckCircle:h["a"]},props:{value:{type:Boolean,required:!0},oldEntryGroup:{type:Object},remainingPersons:{type:Array,required:!0}},data:function(){return{newEntryGroup:this.generateNewEntryGroup(),personFields:[{key:"personId",label:"Personnes"},{key:"removeBtn",label:""}],personOptions:this.generatePersonOptions(),removePersonBtnHover:!1,personRowHoverIndex:-1,reinitSelectPerson:null}},methods:{generateNewEntryGroup:function(){return this.oldEntryGroup?{groupId:this.oldEntryGroup.groupId,persons:Object(L["a"])(this.oldEntryGroup.persons)}:{groupId:null,persons:[]}},reinitEntryModal:function(){this.newEntryGroup=this.generateNewEntryGroup(),this.personOptions=this.generatePersonOptions()},updateEntryGroup:function(){var e=this.personOptions.map((function(e){return{personId:e.value}}));this.$emit("entry-group-to-update",this.newEntryGroup,e),this.showEntryModal=!1},addPerson:function(e){var t;for(this.newEntryGroup.persons.push({personId:e}),t=0;t<this.personOptions.length;t++)if(this.personOptions[t].value==e)break;this.personOptions.splice(t,1),this.reinitSelectPerson=null},removePerson:function(e){var t=this.newEntryGroup.persons[e].personId;this.newEntryGroup.persons.splice(e,1),this.personOptions.push({value:t,text:t}),this.removePersonBtnHover=!1},generatePersonOptions:function(){var e=[];if(this.newEntryGroup){var t,n=Object(u["a"])(this.remainingPersons);try{for(n.s();!(t=n.n()).done;){var r=t.value;e.push({value:r.personId,text:r.personId})}}catch(o){n.e(o)}finally{n.f()}}return e},checkEntryGroup:function(){var e=!0;e&&this.updateEntryGroup()}},watch:{persons:function(){this.personOptions=this.generatePersonOptions()}},computed:{showEntryModal:{get:function(){return this.value},set:function(e){return this.$emit("input",e)}},modalTitle:function(){return this.oldEntryGroup?"Modifier le groupe '"+this.oldEntryGroup.groupId+"'":""}}},ce=le,pe=Object(C["a"])(ce,ae,ue,!1,null,null,null),de=pe.exports,he=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("b-modal",{attrs:{title:"Sauvegarder la proposition"},scopedSlots:e._u([{key:"default",fn:function(){return[n("b-form-group",{attrs:{label:"Titre","label-for":"entryTitle"}},[n("b-form-input",{attrs:{type:"text",required:"",maxlength:"32",placeholder:"Titre de la proposition (e.g. Date + Objet)"},model:{value:e.entryTitle,callback:function(t){e.entryTitle="string"===typeof t?t.trim():t},expression:"entryTitle"}})],1),e.remainingPersons.length>=1?n("p",{staticClass:"text-danger"},[n("span",{staticClass:"font-italic font-weight-bold"},[n("b-icon-exclamation-triangle"),e._v(" Certaines personnes n'ont pas été placées : ")],1),e._v(" "+e._s(e.remainingPersons.map((function(e){return e.personId})).join(", "))+" ")]):e._e()]},proxy:!0},{key:"modal-footer",fn:function(){return[n("b-button",{attrs:{variant:"success"},on:{click:e.saveEntry}},[e._v(" Valider "),n("b-icon-check-circle")],1)]},proxy:!0}]),model:{value:e.showSaveEntryModal,callback:function(t){e.showSaveEntryModal=t},expression:"showSaveEntryModal"}})],1)},ve=[],fe={name:"SaveEntryModal",components:{BModal:y["a"],BButton:m["a"],BFormGroup:b["a"],BFormInput:w["a"],BIconCheckCircle:h["a"]},props:{value:{type:Boolean,required:!0},remainingPersons:{type:Array,required:!0}},data:function(){return{entryTitle:null}},methods:{saveEntry:function(){this.entryTitle.length>=1&&(this.$emit("entry-to-save",this.entryTitle),this.showSaveEntryModal=!1)}},computed:{showSaveEntryModal:{get:function(){return this.value},set:function(e){return this.$emit("input",e)}}}},ye=fe,me=Object(C["a"])(ye,he,ve,!1,null,null,null),ge=me.exports,be=n("d4ec"),we=n("bee2");n("fb6a"),n("159b"),n("99af"),n("13d5");function Ie(e,t){return JSON.stringify([e,t].sort())}function Ge(e,t){return JSON.stringify([e,t])}function Pe(e){return Array.from(e).reduce((function(e,t){return e+t}),0)}function Ce(e){return Math.min.apply(Math,Object(L["a"])(e))}function xe(e){return Math.max.apply(Math,Object(L["a"])(e))}function ke(e,t){return e.every(t)}function Be(e,t){if(!e)throw new Error("Assertion error: "+t)}function Me(e){return e[Math.floor(Math.random()*e.length)]}function Oe(e){for(var t=e.length-1;t>0;t--){var n=Math.floor(Math.random()*(t+1)),r=[e[n],e[t]];e[t]=r[0],e[n]=r[1]}return e}var Se=n("53ca"),Ee=(n("4de4"),function(){function e(t,n,r,o,s,i){Object(be["a"])(this,e),this.personIds=t,this.groupSizes=n,this.pairingCountsMap=r,this.personOccurrencesMap=o,this.groupOccurrencesMap=s,this.constraints=i,this.remainingPersonIds=new Set(this.personIds),this.entry=new Map;var a,l=Object(u["a"])(this.groupSizes.keys());try{for(l.s();!(a=l.n()).done;){var c=a.value;this.entry.set(c,new Set)}}catch(p){l.e(p)}finally{l.f()}}return Object(we["a"])(e,[{key:"generateEntry",value:function(){var e,t=Object(u["a"])(this.constraints);try{for(t.s();!(e=t.n()).done;){var n=e.value,r=n.type,o=n.personIds;if("apart"==r)this.satisfyApartConstraint(o);else if("together"==r){var s=Object.keys(n),i=null,a=null;s.includes("mandatoryGroup")&&(i=n.mandatoryGroup),s.includes("forbiddenGroups")&&(a=n.forbiddenGroups),this.satisfyTogetherConstraint(o,i,a)}}}catch(l){t.e(l)}finally{t.f()}return this.insertCouplesWithLeastOccurrences(),this.insertRemainingPersons(),this.entry}},{key:"satisfyApartConstraint",value:function(e){var t=this,n=Oe(Array.from(e));n.sort((function(e,n){return t.pairingCountsMap.get(e)-t.pairingCountsMap.get(n)}));var r,o=new Set(Array.from(this.entry.keys()).filter((function(e){return t.entry.get(e).size<t.groupSizes.get(e)}))),s=new Set(Array.from(o).filter((function(e){return t.entry.get(e).size>0}))),i=Object(u["a"])(n);try{for(i.s();!(r=i.n()).done;){var a=r.value,l=this.getGroupId(a);if(null==l){if(s.size>0){var c=this.getBestGroupIdsByPersonOccurrences(new Set([a]),s);c.size>1&&(c=this.getBestGroupIdsByGroupOccurrences(new Set([a]),c)),l=Me(Array.from(c)),s.delete(l)}else{var p=this.getBestGroupIdsByGroupOccurrences(new Set([a]),o);l=Me(Array.from(p))}this.entry.get(l).add(a),this.remainingPersonIds.delete(a)}o.delete(l)}}catch(d){i.e(d)}finally{i.f()}}},{key:"satisfyTogetherConstraint",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=Oe(Array.from(e));o.sort((function(e,n){return t.pairingCountsMap.get(e)-t.pairingCountsMap.get(n)}));var s,i=new Set,a=[],l=Object(u["a"])(o);try{for(l.s();!(s=l.n()).done;){var c=s.value,p=this.getGroupId(c);null!=p?i.add(p):a.push(c)}}catch(C){l.e(C)}finally{l.f()}if(i.size>0){var d,h=Object(u["a"])(a);try{for(h.s();!(d=h.n()).done;){var v=d.value,f=this.getBestGroupIdsByPersonOccurrences(new Set([v]),i);if(f){f.size>1&&(f=this.getBestGroupIdsByGroupOccurrences(new Set([v]),f));var y=Me(Array.from(f));this.entry.get(y).add(v),this.remainingPersonIds.delete(v)}}}catch(C){h.e(C)}finally{h.f()}}else if(null!=n){var m,g=Object(u["a"])(o);try{for(g.s();!(m=g.n()).done;){var b=m.value;this.entry.get(n).size<this.groupSizes.get(n)&&(this.entry.get(n).add(b),this.remainingPersonIds.delete(b))}}catch(C){g.e(C)}finally{g.f()}}else{var w=new Set(this.groupSizes.keys());null!=r&&(w=new Set(Array.from(w).filter((function(e){return!r.has(e)}))));var I=new Set;while(0==I.size)I=this.getBestGroupIdsByPersonOccurrences(new Set(o),w),0==I.size?(I=this.getBestGroupIdsByGroupOccurrences(new Set(o),w),0==I.size&&o.pop()):I.size>1&&(I=this.getBestGroupIdsByGroupOccurrences(I,w));var G=Me(Array.from(I)),P=new Set(o);P.forEach((function(e){return t.entry.get(G).add(e)})),this.remainingPersonIds=new Set(Array.from(this.remainingPersonIds).filter((function(e){return!P.has(e)})))}}},{key:"insertCouplesWithLeastOccurrences",value:function(){var e=this,t=Oe(Array.from(this.personOccurrencesMap.values()));t.sort((function(t,n){if(t.count<n.count)return-1;if(t.count>n.count)return 1;var r=Math.min(e.pairingCountsMap.get(t.person1Id),e.pairingCountsMap.get(t.person2Id)),o=Math.min(e.pairingCountsMap.get(n.person1Id),e.pairingCountsMap.get(n.person2Id));return r-o}));var n=new Set(Array.from(this.groupSizes.keys()).filter((function(t){return 0==e.entry.get(t).size})));while(this.remainingPersonIds.size>=2){var r=t.shift(),o=r.person1Id,s=r.person2Id;if(!this.remainingPersonIds.has(o)&&!this.remainingPersonIds.has(s)){var i=function(){var t=new Set([o,s]),r=e.getBestGroupIdsByGroupOccurrences(t,n);if(0==r.size)return{v:void 0};var i=Me(Array.from(r));t.forEach((function(t){return e.entry.get(i).add(t)})),e.remainingPersonIds.delete(o),e.remainingPersonIds.delete(s),n.delete(i)}();if("object"===Object(Se["a"])(i))return i.v}}}},{key:"insertRemainingPersons",value:function(){var e=this,t=Oe(Array.from(this.remainingPersonIds));t.sort((function(t,n){return e.pairingCountsMap.get(t)-e.pairingCountsMap.get(n)}));while(t.length>0){var n=t.shift(),r=this.getBestGroupIdsByPersonOccurrences(new Set([n]));r.size>1&&(r=this.getBestGroupIdsByGroupOccurrences(new Set([n]),r));var o=Me(Array.from(r));this.entry.get(o).add(n)}while(t.length>0){var s=t.shift(),i=this.getBestGroupIdsByGroupOccurrences(new Set([s])),a=Me(Array.from(i));this.entry.get(a).add(s)}}},{key:"getGroupId",value:function(e){var t,n=Object(u["a"])(this.entry.entries());try{for(n.s();!(t=n.n()).done;){var r=Object(ie["a"])(t.value,2),o=r[0],s=r[1];if(s.has(e))return o}}catch(i){n.e(i)}finally{n.f()}return null}},{key:"getBestGroupIdsByPersonOccurrences",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=new Set(this.groupSizes.keys());if((null==n||Array.from(n).some((function(e){return!r.has(e)})))&&(n=r),n=new Set(Array.from(n).filter((function(n){return t.entry.get(n).size>0&&t.entry.get(n).size+e.size<=t.groupSizes.get(n)}))),0==n.size)return new Set;var o,s=new Map,i=Object(u["a"])(n);try{for(i.s();!(o=i.n()).done;){var a=o.value;s.set(a,[]);var l,c=Object(u["a"])(e);try{for(c.s();!(l=c.n()).done;){var p,d=l.value,h=Object(u["a"])(this.entry.get(a));try{for(h.s();!(p=h.n()).done;){var v=p.value,f=Ie(d,v),y=this.personOccurrencesMap.get(f).count;s.get(a).push(y)}}catch(b){h.e(b)}finally{h.f()}}}catch(b){c.e(b)}finally{c.f()}}}catch(b){i.e(b)}finally{i.f()}var m=Ce(Array.from(n).map((function(e){return Pe(s.get(e))/s.get(e).length})));n=new Set(Array.from(n).filter((function(e){return Pe(s.get(e))/s.get(e).length==m})));var g=xe(Array.from(n).map((function(e){return t.groupSizes.get(e)})));return n=new Set(Array.from(n).filter((function(e){return t.groupSizes.get(e)==g}))),n}},{key:"getBestGroupIdsByGroupOccurrences",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=new Set(this.groupSizes.keys());if((null==n||Array.from(n).some((function(e){return!r.has(e)})))&&(n=r),n=new Set(Array.from(n).filter((function(n){return t.entry.get(n).size+e.size<=t.groupSizes.get(n)}))),0==n.size)return new Set;var o,s=new Map,i=Object(u["a"])(n);try{for(i.s();!(o=i.n()).done;){var a=o.value;s.set(a,[]);var l,c=Object(u["a"])(e);try{for(c.s();!(l=c.n()).done;){var p=l.value,d=Ge(p,a),h=this.groupOccurrencesMap.get(d).count;s.get(a).push(h)}}catch(y){c.e(y)}finally{c.f()}}}catch(y){i.e(y)}finally{i.f()}var v=Ce(Array.from(n).map((function(e){return Pe(s.get(e))/s.get(e).length})));n=new Set(Array.from(n).filter((function(e){return Pe(s.get(e))/s.get(e).length==v})));var f=xe(Array.from(n).map((function(e){return t.groupSizes.get(e)})));return n=new Set(Array.from(n).filter((function(e){return t.groupSizes.get(e)==f}))),n}}]),e}()),je=Ee,He=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;Object(be["a"])(this,e),r||(r=[]),o||(o=[]),this.checkPositiveGroupSizes(n),this.checkSufficientGroupSizes(t,n);var s,i=Object(u["a"])(r);try{for(i.s();!(s=i.n()).done;){var a=s.value;this.checkEntryValidity(a)}}catch(l){i.e(l)}finally{i.f()}this.personIds=t,this.groupSizes=n,this.history=r,this.checkConstraintsValidity(o),this.constraints=o}return Object(we["a"])(e,[{key:"getOccurrencesMaps",value:function(){var e,t=new Map,n=new Map,r=new Map,o=Array.from(this.personIds),s=Object(u["a"])(o.entries());try{for(s.s();!(e=s.n()).done;){var i=Object(ie["a"])(e.value,2),a=i[0],l=i[1];t.set(l,0);var c,p=Object(u["a"])(o.slice(a+1));try{for(p.s();!(c=p.n()).done;){var d=c.value;if(l!=d){var h=Ie(l,d);n.set(h,{person1Id:l,person2Id:d,count:0})}}}catch(N){p.e(N)}finally{p.f()}var v,f=Object(u["a"])(this.groupSizes.keys());try{for(f.s();!(v=f.n()).done;){var y=v.value,m=Ge(l,y);r.set(m,{personId:l,groupId:y,count:0})}}catch(N){f.e(N)}finally{f.f()}}}catch(N){s.e(N)}finally{s.f()}var g,b=Object(u["a"])(this.history);try{for(b.s();!(g=b.n()).done;){var w,I=g.value,G=Object(u["a"])(I.entries());try{for(G.s();!(w=G.n()).done;){var P,C=Object(ie["a"])(w.value,2),x=C[0],k=C[1],B=Array.from(k),M=Object(u["a"])(B.entries());try{for(M.s();!(P=M.n()).done;){var O=Object(ie["a"])(P.value,2),S=O[0],E=O[1],j=t.get(E)+k.size-1;t.set(E,j);var H,_=Object(u["a"])(B.slice(S+1));try{for(_.s();!(H=_.n()).done;){var z=H.value;if(this.personIds.has(E)&&this.personIds.has(z)){var A=Ie(E,z);n.get(A).count++}}}catch(N){_.e(N)}finally{_.f()}var $=Ge(E,x);r.get($).count++}}catch(N){M.e(N)}finally{M.f()}}}catch(N){G.e(N)}finally{G.f()}}}catch(N){b.e(N)}finally{b.f()}return[t,n,r]}},{key:"getNewEntry",value:function(){var e=this.getOccurrencesMaps(),t=Object(ie["a"])(e,3),n=t[0],r=t[1],o=t[2],s=new je(this.personIds,this.groupSizes,n,r,o,this.constraints);return s.generateEntry()}},{key:"checkPositiveGroupSizes",value:function(e){Be(ke(Array.from(e.values()),(function(e){return e>=1})),"At least one group has a negative or null size.")}},{key:"checkSufficientGroupSizes",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;null==e&&(e=this.personIds),null==t&&(t=this.groupSizes),Be(e.size<=Pe(Array.from(t.values())),"The groups cannot contain all the persons.")}},{key:"checkEntryValidity",value:function(e){var t,n=new Set,r=Object(u["a"])(e.values());try{for(r.s();!(t=r.n()).done;){var o,s=t.value,i=Object(u["a"])(s);try{for(i.s();!(o=i.n()).done;){var a=o.value;if(n.has(a))return!1;n.add(a)}}catch(l){i.e(l)}finally{i.f()}}}catch(l){r.e(l)}finally{r.f()}return!0}},{key:"checkConstraintsValidity",value:function(e){var t=this,n=new Set(this.groupSizes.keys());e.forEach((function(e,r){var o,s=Object.keys(e),i=e.personIds,a=Object(u["a"])(i);try{for(a.s();!(o=a.n()).done;){var l=o.value;Be(t.personIds.has(l),"The person '".concat(l,"' in constraint #'").concat(r,"' does not exist."))}}catch(f){a.e(f)}finally{a.f()}if(s.includes("mandatoryGroup")&&null!=e.mandatoryGroup){var c=e.mandatoryGroup;Be(n.has(c),"The mandatory group '".concat(c,"' in constraint #").concat(r+1," does not exist."))}if(s.includes("forbiddenGroups")&&null!=e.forbiddenGroups){var p,d=e.forbiddenGroups,h=Object(u["a"])(d);try{for(h.s();!(p=h.n()).done;){var v=p.value;Be(n.has(v),"The forbidden group '".concat(v,"' in constraint #").concat(r+1," does not exist."))}}catch(f){h.e(f)}finally{h.f()}}}))}},{key:"setPersonIds",value:function(e){this.checkSufficientGroupSizes(e),this.personIds=e}},{key:"setGroupSizes",value:function(e){this.checkPositiveGroupSizes(e),this.checkSufficientGroupSizes(null,e),this.groupSizes=e}},{key:"setConstraints",value:function(e){this.checkConstraintsValidity(e),this.constraints=e}},{key:"saveEntry",value:function(e){this.checkEntryValidity(e),this.history.push(e)}}]),e}(),_e=He,ze={name:"EntryPane",components:{BTable:d["a"],BIconCheckCircle:h["a"],BIconPencil:h["b"],BIconPlayCircle:h["c"],EntryModal:de,SaveEntryModal:ge},props:{groups:{type:Array,required:!0},persons:{type:Array,required:!0},constraints:{type:Array,required:!0},history:{type:Array,required:!0}},data:function(){return{entry:{title:null,groups:[]},entryFields:[{key:"groupId",label:"Groupe"},{key:"personIds",label:"Personnes"},{key:"updateBtn",label:""}],remainingPersons:[],generateEntryBtnHover:!1,saveEntryBtnHover:!1,updateEntryGroupBtnHover:!1,entryGroupRowHoverIndex:-1,activeIndex:-1,activeEntryGroup:null,showEntryModal:!1,showSaveEntryModal:!1}},methods:{generateEntry:function(){var e,t=new Set(this.persons.map((function(e){return e.personId}))),n=new Map(this.groups.map((function(e){return[e.groupId,e.size]}))),r=[],o=Object(u["a"])(this.history);try{for(o.s();!(e=o.n()).done;){var s,i=e.value,a=new Map,l=Object(u["a"])(i.groups);try{for(l.s();!(s=l.n()).done;){var c=s.value;a.set(c.groupId,new Set(c.persons.map((function(e){return e.personId}))))}}catch(C){l.e(C)}finally{l.f()}r.push(a)}}catch(C){o.e(C)}finally{o.f()}var p,d=[],h=Object(u["a"])(this.constraints);try{for(h.s();!(p=h.n()).done;){var v=p.value,f=Object.keys(v),y={type:v.type,personIds:new Set(v.persons.map((function(e){return e.personId})))};f.includes("mandatoryGroup")&&(y.mandatoryGroup=v.mandatoryGroup),f.includes("forbiddenGroups")&&(y.forbiddenGroups=new Set(v.forbiddenGroups.map((function(e){return e.groupId})))),d.push(y)}}catch(C){h.e(C)}finally{h.f()}var m=new _e(t,n,r,d),g=m.getNewEntry();this.entry={title:null,groups:[]};var b,w=Object(u["a"])(g);try{for(w.s();!(b=w.n()).done;){var I=Object(ie["a"])(b.value,2),G=I[0],P=I[1];this.entry.groups.push({groupId:G,persons:Array.from(P).map((function(e){return{personId:e}}))})}}catch(C){w.e(C)}finally{w.f()}this.remainingPersons=[]},saveEntry:function(e){this.entry.title=e,this.$emit("entry-to-save",this.entry),this.entry={title:null,groups:[]},this.remainingPersons=[]},openEntryModal:function(e){this.activeIndex=e,this.activeEntryGroup=this.entry.groups[e],this.showEntryModal=!0},updateEntryGroup:function(e,t){this.entry.groups.splice(this.activeIndex,1,e),this.remainingPersons=t}}},Ae=ze,$e=Object(C["a"])(Ae,oe,se,!1,null,null,null),Ne=$e.exports,Te=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e._m(0),n("div",{staticClass:"accordion",attrs:{role:"tablist"}},e._l(e.history,(function(t,r){return n("b-card",{key:r,staticClass:"mb-1",attrs:{"no-body":""}},[n("b-card-header",{staticClass:"p-1",attrs:{"header-tag":"header",role:"tab"}},[n("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:"entry"+r,expression:"'entry' + index"}],staticClass:"text-body",attrs:{block:"",variant:"link"}},[e._v(" "+e._s(t.title)+" ")])],1),n("b-collapse",{attrs:{id:"entry"+r,accordion:"historyAccordion",role:"tabpanel"}},[n("b-table",{attrs:{small:"",striped:"",hover:"",fields:e.entryFields,items:t.groups},on:{"row-hovered":function(t,n){return e.entryGroupRowHoverIndex=n},"row-unhovered":function(t,n){return e.entryGroupRowHoverIndex=-1}},scopedSlots:e._u([{key:"cell(personIds)",fn:function(t){return[e._v(" "+e._s(t.item.persons.map((function(e){return e.personId})).join(", "))+" ")]}}],null,!0)}),n("button",{directives:[{name:"b-hover",rawName:"v-b-hover",value:function(t){return e.removeEntryBtnHover=t},expression:"hover => removeEntryBtnHover = hover"}],class:"btn btn-link btn-sm "+(e.removeEntryBtnHover?"text-danger":"text-body"),on:{click:function(t){return e.removeEntry(r)}}},[e._v(" Supprimer l'entrée "),n("b-icon-x-circle")],1)],1)],1)})),1)])},Fe=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"sticky-top bg-light d-inline-block w-100"},[n("span",{staticClass:"float-left h5"},[e._v("Historique")])])}],Re=n("5843"),qe=n("205f"),Je=n("b885"),Ve={name:"HistoryPane",components:{BTable:d["a"],BButton:m["a"],BCollapse:Re["a"],BCard:qe["a"],BCardHeader:Je["a"],BIconXCircle:h["e"]},props:{history:{type:Array,required:!0}},data:function(){return{entryFields:[{key:"groupId",label:"Groupe"},{key:"personIds",label:"Personnes"}],removeEntryBtnHover:!1,activeEntry:null,activeEntryGroup:null,showEntryModal:!1}},methods:{removeEntry:function(e){this.$emit("entry-to-remove",e)}}},De=Ve,Xe=Object(C["a"])(De,Te,Fe,!1,null,null,null),Le=Xe.exports,We="MemoMix--",Ke="default";function Qe(e){return We+e+"--Groups"}function Ue(e){return We+e+"--Persons"}function Ye(e){return We+e+"--Constraints"}function Ze(e){return We+e+"--History"}function et(){return We+"CurrentProject"}function tt(){return We+"Projects"}var nt={name:"App",components:{Splitpanes:l["Splitpanes"],Pane:l["Pane"],GroupPane:S,PersonPane:q,ConstraintPane:re,EntryPane:Ne,HistoryPane:Le},data:function(){return{currentProject:null,projects:[],groups:[],persons:[],constraints:[],history:[]}},mounted:function(){this.currentProject=localStorage.getItem(et()),null==this.currentProject?(this.currentProject=Ke,localStorage.setItem(et(),Ke),localStorage.setItem(tt(),JSON.stringify([Ke])),this.saveGroups(),this.savePersons(),this.saveConstraints(),this.saveHistory()):this.switchProject(this.currentProject)},methods:{updateGroup:function(e,t,n){var r,o=this.groups[e].groupId,s=t.groupId,i=Object(u["a"])(this.constraints);try{for(i.s();!(r=i.n()).done;){var a=r.value;a.inGroup==o&&(a.inGroup=s);var l=a.notInGroups.find((function(e){var t=e.groupId;return t==o}));l&&(l.groupId=s)}}catch(y){i.e(y)}finally{i.f()}if(this.saveGroups(),n){var c,p=Object(u["a"])(this.history);try{for(p.s();!(c=p.n()).done;){var d,h=c.value,v=Object(u["a"])(h.groups);try{for(v.s();!(d=v.n()).done;){var f=d.value;f.groupId==o&&(f.groupId=s)}}catch(y){v.e(y)}finally{v.f()}}}catch(y){p.e(y)}finally{p.f()}this.saveHistory()}this.groups.splice(e,1,t)},addGroup:function(e){this.groups.push(e),this.saveGroups()},removeGroup:function(e){this.groups.splice(e,1),this.saveGroups()},updatePerson:function(e,t,n){var r,o=this.persons[e].personId,s=t.personId,i=Object(u["a"])(this.constraints);try{for(i.s();!(r=i.n()).done;){var a=r.value,l=a.persons.find((function(e){var t=e.personId;return t==o}));l&&(l.personId=s)}}catch(b){i.e(b)}finally{i.f()}if(this.savePersons(),n){var c,p=Object(u["a"])(this.history);try{for(p.s();!(c=p.n()).done;){var d,h=c.value,v=Object(u["a"])(h.groups);try{for(v.s();!(d=v.n()).done;){var f,y=d.value,m=Object(u["a"])(y.persons);try{for(m.s();!(f=m.n()).done;){var g=f.value;g.personId==o&&(g.personId=s)}}catch(b){m.e(b)}finally{m.f()}}}catch(b){v.e(b)}finally{v.f()}}}catch(b){p.e(b)}finally{p.f()}this.saveHistory()}this.persons.splice(e,1,t)},addPerson:function(e){this.persons.push(e),this.savePersons()},removePerson:function(e){this.persons.splice(e,1),this.savePersons()},updateConstraint:function(e,t){this.constraints.splice(e,1,t),this.saveConstraints()},addConstraint:function(e){this.constraints.push(e),this.saveConstraints()},removeConstraint:function(e){this.constraints.splice(e,1),this.saveConstraints()},saveEntry:function(e){this.history.push(e),this.saveHistory()},removeEntry:function(e){this.history.splice(e,1),this.saveHistory()},switchProject:function(e){this.groups=JSON.parse(localStorage.getItem(Qe(e))),this.persons=JSON.parse(localStorage.getItem(Ue(e))),this.constraints=JSON.parse(localStorage.getItem(Ye(e))),this.history=JSON.parse(localStorage.getItem(Ze(e))),this.currentProject=e},saveGroups:function(){localStorage.setItem(Qe(this.currentProject),JSON.stringify(this.groups))},savePersons:function(){localStorage.setItem(Ue(this.currentProject),JSON.stringify(this.persons))},saveConstraints:function(){localStorage.setItem(Ye(this.currentProject),JSON.stringify(this.constraints))},saveHistory:function(){localStorage.setItem(Ze(this.currentProject),JSON.stringify(this.history))}}},rt=nt,ot=(n("034f"),Object(C["a"])(rt,i,a,!1,null,null,null)),st=ot.exports;r["a"].directive("b-hover",o["a"]),r["a"].directive("b-toggle",s["a"]),new r["a"]({el:"#app",render:function(e){return e(st)}})},"85ec":function(e,t,n){}});
//# sourceMappingURL=index.2832c54a.js.map